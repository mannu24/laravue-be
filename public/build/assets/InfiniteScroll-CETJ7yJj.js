import{c as Q,_ as K,ag as O,r as h,m as G,a as B,C as j,P as J,z as R,an as U,o as v,j as F,w as n,f as o,e as l,d as s,y as g,n as p,g as f,t as y,b as k,V as M,p as X,l as L,X as E,s as H,N,F as P,h as z,J as W,k as Y,ak as Z}from"./app-BYKYNp4m.js";import{a as ee,b as te,c as se,d as ae,e as oe,f as ne,g as le,h as ie,i as re,P as ue}from"./PostCard-kDCaobDP.js";import{_ as ce,a as de}from"./CardContent-C-Vk5b1h.js";import{_ as fe,a as me,b as ve}from"./CardTitle-DD1DMKAN.js";import{_ as ge}from"./CardFooter-CQ0oXYle.js";/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=Q("EllipsisVerticalIcon",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),pe={class:"flex items-center justify-between"},_e={key:0,class:"relative inline-block ml-auto self-start"},xe={key:0,class:"absolute mt-1 right-2 z-10 w-32 origin-top-right divide-y divide-gray-100 rounded-md focus:outline-hidden",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",tabindex:"-1"},ye={class:"",role:"none"},ke={class:"flex items-center space-x-2 mt-2"},be=["src"],we={class:"flex items-center space-x-4"},qe=["title"],$e=["title"],Ce=["title"],Se={class:"flex items-center space-x-2"},Ae={title:"Posted At",class:"text-gray-500 cursor-pointer text-sm"},De={title:"Share Post",class:"text-gray-500 cursor-pointer hover:text-red-400"},Ve={__name:"QuestionCard",props:["question"],emits:["load_more","fetch","delete_question","liked_action","share_url"],setup(e,{emit:b}){const{toast:$}=O(),_=h(null),m=h(!1),c=b,i=G(),d=B(),C=j(()=>"/question/"+e.question.slug),A=r=>{i.push({name:"question",params:{id:r}})};J(()=>{var r;(r=_==null?void 0:_.value)!=null&&r.classList.contains("last_item")&&S()});const D=async()=>{m.value=!1,await E.delete(`/api/v1/questions/${e.question.slug}`,d.config).then(()=>{c("delete_question",e.question.slug)})},S=()=>{new IntersectionObserver(t=>{t.forEach(q=>{q.isIntersecting&&c("load_more")})}).observe(_.value)},w=async()=>{if(!d.isAuthenticated)i.push("/login");else{const r=await E.get(`/api/v1/questions/like-unlike/${e.question.slug}`,d.config);r.data.status=="success"?c("liked_action",[e.question.slug,r.data.liked]):$({title:"Error",description:"Something went wrong",variant:"destructive"})}},V=()=>{d.isAuthenticated?i.push(C.value):i.push("/login")},I=()=>{c("share_url",C.value)};return(r,t)=>{const q=R("router-link"),a=U("click-outside");return v(),F(l(de),{class:p(["mb-4 transition-colors duration-200","bg-white text-gray-800 border-gray-200","dark:bg-gray-800 dark:text-white dark:border-gray-700"])},{default:n(()=>[o(l(fe),null,{default:n(()=>[s("div",pe,[o(l(me),{class:"text-xl font-bold"},{default:n(()=>[o(q,{to:`/qna/${e.question.slug}`,onClick:t[0]||(t[0]=g(u=>A(e.question.slug),["prevent"])),class:p(["hover:underline","text-blue-600 hover:text-blue-700","dark:text-blue-400 dark:hover:text-blue-300"])},{default:n(()=>[f(y(e.question.title),1)]),_:1},8,["to"])]),_:1}),l(d).isAuthenticated&&e.question.owner?(v(),k("div",_e,[s("p",{title:"More Options",class:"icon-hover text-gray-500 hover:bg-primary/20 hover:text-primary hover:bg-opacity-25",onClick:t[1]||(t[1]=g(u=>m.value=!m.value,["stop"]))},[o(l(he))]),o(M,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:n(()=>[m.value?X((v(),k("div",xe,[s("div",ye,[s("div",{onClick:t[2]||(t[2]=g(u=>r.$router.push("/qna/ask/"+e.question.slug),["stop"])),class:"block px-4 py-2 text-sm text-gray-700 cursor-pointer transition-all duration-150 ease-in-out rounded-md shadow dark:shadow-white/10 bg-white dark:text-white dark:bg-gray-900 dark:hover:bg-gray-800/80 hover:bg-gray-200 mb-1"},t[4]||(t[4]=[s("i",{class:"fas fa-pencil-alt mr-1"},null,-1),f(" Edit ")])),o(l(ee),null,{default:n(()=>[o(l(te),{"as-child":""},{default:n(()=>[s("div",{onClick:t[3]||(t[3]=g(()=>{},["stop"])),class:"block px-4 py-2 text-sm text-gray-700 cursor-pointer transition-all duration-150 ease-in-out rounded-md shadow dark:shadow-white/10 bg-white dark:text-white dark:bg-gray-900 dark:hover:bg-gray-800/80 hover:bg-gray-200"},t[5]||(t[5]=[s("i",{class:"fas fa-trash mr-1"},null,-1),f(" Delete ")]))]),_:1}),o(l(se),null,{default:n(()=>[o(l(ae),null,{default:n(()=>[o(l(oe),null,{default:n(()=>t[6]||(t[6]=[f("Are you absolutely sure?")])),_:1}),o(l(ne),null,{default:n(()=>t[7]||(t[7]=[f(" This action cannot be undone. This will delete your post. ")])),_:1})]),_:1}),o(l(le),null,{default:n(()=>[o(l(ie),null,{default:n(()=>t[8]||(t[8]=[f("Cancel")])),_:1}),o(l(re),{onClick:g(D,["stop"])},{default:n(()=>t[9]||(t[9]=[f("Continue")])),_:1})]),_:1})]),_:1})]),_:1})])])),[[a,{closeCondition:()=>m.value,closeAction:()=>m.value=!1}]]):L("",!0)]),_:1})])):L("",!0)]),o(l(ve),{class:p(["dark:text-gray-400","text-gray-600"])},{default:n(()=>{var u;return[s("div",ke,[s("img",{src:((u=e.question.user)==null?void 0:u.profile_photo)||"/assets/front/images/user.png",alt:"User Avatar",class:p(["w-6 h-6 rounded-full border",["dark:border-gray-600","border-gray-300"]])},null,8,be),s("span",null,y(e.question.user?e.question.user.name:"Anonymous"),1)])]}),_:1})]),_:1}),o(l(ce),{class:p(["dark:text-gray-300","text-gray-700"])},{default:n(()=>[s("p",null,y(e.question.content.substring(0,200))+"...",1)]),_:1}),o(l(ge),{class:"flex items-center justify-between py-2 px-4 pt-0"},{default:n(()=>[s("div",we,[s("span",{title:e.question.likes_count+" Likes",class:"text-gray-500 cursor-pointer hover:text-red-400"},[s("i",{class:p(["fa-heart",e.question.liked?"fas text-red-500":"far"]),onClick:g(w,["stop"])},null,2),f(" "+y(e.question.likes_count),1)],8,qe),s("span",{title:e.question.comments_count+" Comments",class:"text-gray-500 cursor-pointer hover:text-red-400"},[s("i",{class:"far fa-messages",onClick:g(V,["stop"])}),f(" "+y(e.question.comments_count),1)],8,$e),s("span",{title:e.question.views_count+" Views",class:"text-gray-500 cursor-pointer hover:text-red-400"},[t[10]||(t[10]=s("i",{class:"far fa-chart-column"},null,-1)),f(" "+y(e.question.views_count),1)],8,Ce)]),s("div",Se,[s("span",Ae,y(e.question.posted_at),1),t[11]||(t[11]=s("span",{class:"bg-red-400 w-[5px] h-[5px] rounded"},null,-1)),s("span",De,[s("i",{class:"far fa-paper-plane-top",onClick:g(I,["stop"])})])])]),_:1})]),_:1})}}},Ie=K(Ve,[["__scopeId","data-v-7c0027a4"]]),Le={__name:"Skeleton",props:{class:{type:null,required:!1}},setup(e){const b=e;return($,_)=>(v(),k("div",{class:p(l(H)("animate-pulse rounded-md bg-muted",b.class))},null,2))}},Te={class:"max-w-2xl mx-auto flex flex-col gap-4 sm:px-6 pb-5 infinite-scroll-container"},Ee={key:0,class:"gap-4 grid max-w-2xl mx-auto w-full"},Fe={__name:"InfiniteScroll",props:["fetchKey","username","scrolling"],emits:["share_url"],setup(e,{emit:b}){const $=B(),_=h(null),m=h(null),c=h(1),i=h([]),d=h(!1),C=h(1),A=b,D=j(()=>{if(e.scrolling=="post")return"/api/v1/feed?page="+c.value;if(e.scrolling=="qna")return"/api/v1/questions-feed?page="+c.value}),S=()=>{c.value=1,i.value=[]},w=async()=>{d.value||(d.value=!0,await axios.post(D.value,{username:e.username},$.config).then(a=>{i.value.push(...a.data.records.data),m.value=a.data.records.data.length,d.value=!1,_.value={page:a.data.records.current_page,pageSize:a.data.records.per_page,pageCount:a.data.records.last_page,total:a.data.records.total}}))},V=a=>{i.value=i.value.filter(u=>u.post_code!==a)},I=a=>{i.value=i.value.filter(u=>u.slug!==a)},r=()=>{m.value>0&&(c.value++,w())},t=a=>{A("share_url",a)},q=async a=>{i.value.find((u,x)=>{u.post_code===a[0]&&(i.value[x].liked=a[1],a[1]?i.value[x].likes_count++:i.value[x].likes_count--)})};return w(),N(c,async a=>{w()}),N(()=>e.fetchKey,async a=>{S()}),(a,u)=>(v(),k("div",Te,[o(Z,{name:"fade",appear:""},{default:n(()=>[(v(!0),k(P,null,z(i.value,(x,T)=>(v(),F(Y(e.scrolling==="post"?ue:Ie),W({key:T,onShare_url:t,onFetch:S,onLiked_action:q,onDelete_post:V,onDelete_question:I,onLoad_more:r,class:T===i.value.length-C.value?"last_item":"",ref_for:!0},{[e.scrolling==="post"?"post":"question"]:x}),null,16,["class"]))),128))]),_:1}),o(M,{class:"mx-auto",name:"fade"},{default:n(()=>[d.value?(v(),k("div",Ee,[(v(),k(P,null,z(5,x=>o(l(Le),{key:x,class:p(["w-full",e.scrolling=="post"?"h-[300px]":"h-[200px]"])},null,8,["class"])),64))])):L("",!0)]),_:1})]))}};export{Fe as _};
//# sourceMappingURL=InfiniteScroll-CETJ7yJj.js.map
