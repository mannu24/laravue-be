import{_ as le,k as ne,t as ie,j as Z,a as v,f as x,o as u,w as f,D as n,d as g,x as S,u as c,H as b,V as ce,z as L,A as p,b as N,F as G,E as H,G as Y,W as ue,C as de,ag as R,I as Q,p as w,l as V,N as ge,m as pe,at as X}from"./app-Bvnl7d0n.js";import{a as fe}from"./PostCard-6SO9_3tv.js";import{C as he,Q as me}from"./QuestionCard-DKej05gX.js";import{_ as ve}from"./Card-hOl-Usuy.js";import{_ as xe}from"./CardContent-BNEtnmat.js";import{_ as P}from"./index-_SePG6eE.js";import{F as ye,D as be}from"./flame-Dy2j6U5p.js";import{C as we}from"./calendar-TcdMNaSw.js";import{E as je}from"./external-link-CohcApp6.js";import{_ as _e}from"./Skeleton-wSYT3jvc.js";import{_ as ke}from"./EmptyState-DVLWfdwK.js";import{L as Ce}from"./LoadingSpinner-ekVe37eh.js";const Pe={class:"relative overflow-hidden"},Se=["src","alt"],Ne={class:"absolute top-4 left-4 flex gap-2"},$e={class:"absolute top-4 right-4"},qe={class:"flex items-center gap-3"},De=["src","alt"],Le={class:"text-sm font-medium text-gray-900 dark:text-white"},Ae={class:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-1"},Te={class:"text-2xl font-semibold text-gray-900 dark:text-white mb-3 leading-tight transition line-clamp-2"},Fe={class:"text-sm text-gray-600 dark:text-gray-300 leading-relaxed"},Ie={class:"flex flex-wrap gap-2"},ze={key:0,class:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-white/5 text-sm text-gray-600 dark:text-gray-300"},Ee={class:"flex items-center gap-4"},Be={class:"flex items-center gap-1 text-gray-600 dark:text-gray-400"},Re={__name:"ProjectCard",props:{project:{type:Object,required:!0},showActions:{type:Boolean,default:!0}},emits:["upvoted","viewed"],setup(t,{emit:U}){const e=t,A=U,j=ne(),_=ie(),k=Z(),y=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",i=async r=>{var s;if((s=r==null?void 0:r.stopPropagation)==null||s.call(r),!k.isAuthenticated){R({title:"Authentication Required",description:"Please login to upvote projects",variant:"destructive"});return}try{const d=await Q.post(`/api/v1/projects/${e.project.slug}/upvote`,{},k.config);e.project.is_upvoted_by_user=d.data.data.is_upvoted,e.project.upvotes_count=d.data.data.upvotes_count,A("upvoted",e.project),R({title:"Success",description:d.data.message})}catch(d){console.error("Error upvoting project:",d),R({title:"Error",description:"Failed to upvote project",variant:"destructive"})}},h=r=>{navigator.clipboard.writeText(r),R({title:"Link Copied",description:"Project link copied to clipboard"})},K=async r=>{var d;(d=r==null?void 0:r.stopPropagation)==null||d.call(r);const s=`${window.location.origin}/projects/${e.project.slug}`;if(navigator.share)try{await navigator.share({title:e.project.title,text:e.project.description,url:s})}catch($){$.name!=="AbortError"&&h(s)}else h(s)},C=()=>{j.push(`/projects/${e.project.slug}`),A("viewed",e.project)},m=v(()=>e.project.trending_score>50||e.project.is_featured),M=v(()=>{const r=e.project.created_at?new Date(e.project.created_at):null;return r?(new Date-r)/(1e3*60*60*24)<=7:!1}),O=v(()=>{var r;return((r=e.project.category)==null?void 0:r.name)||e.project.industry||"Project"});return(r,s)=>(u(),x(c(ve),{class:L(["group relative overflow-hidden rounded-3xl transition-all duration-500 hover:scale-[1.01] hover:shadow-2xl cursor-pointer",c(_).isDark?"bg-gray-900/80 border border-white/5":"bg-white border border-gray-200"]),onClick:C},{default:f(()=>[n("div",Pe,[n("img",{src:t.project.featured_image||"https://picsum.photos/400/250?random="+t.project.id,alt:t.project.title,class:"w-full h-56 object-cover transition-transform duration-500 group-hover:scale-110"},null,8,Se),s[2]||(s[2]=n("div",{class:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"},null,-1)),n("div",Ne,[m.value?(u(),x(c(P),{key:0,class:"bg-gradient-to-r from-blue-500 to-indigo-500 text-white border-0 shadow-lg text-xs"},{default:f(()=>[g(c(ye),{class:"w-3 h-3 mr-1"}),s[0]||(s[0]=b(" Trending ",-1))]),_:1})):S("",!0),M.value?(u(),x(c(P),{key:1,class:"bg-gradient-to-r from-purple-500 to-indigo-500 text-white border-0 shadow-lg text-xs"},{default:f(()=>[g(c(ce),{class:"w-3 h-3 mr-1"}),s[1]||(s[1]=b(" New ",-1))]),_:1})):S("",!0)]),n("div",$e,[g(c(P),{class:L(["text-white font-semibold shadow-lg border-0 px-3 py-1",t.project.is_sellable?"bg-gradient-to-r from-blue-500 via-purple-500 to-indigo-500":"bg-gradient-to-r from-emerald-500 to-teal-500"])},{default:f(()=>[b(p(t.project.is_sellable?"Premium":"Open Source"),1)]),_:1},8,["class"])])]),g(c(xe),{class:"p-6 space-y-5"},{default:f(()=>{var d,$,T,q,F,I,z,E;return[n("div",qe,[n("img",{src:((d=t.project.user)==null?void 0:d.profile_photo)||`https://ui-avatars.com/api/?name=${($=t.project.user)==null?void 0:$.name}&background=random`,alt:(T=t.project.user)==null?void 0:T.name,class:"w-10 h-10 rounded-full border border-gray-200 dark:border-white/10"},null,8,De),n("div",null,[n("p",Le,p((q=t.project.user)==null?void 0:q.name),1),n("p",Ae,[g(c(we),{class:"w-3 h-3"}),b(" "+p(y(t.project.created_at)),1)])]),g(c(P),{variant:"secondary",class:"ml-auto text-xs"},{default:f(()=>[b(p(O.value),1)]),_:1})]),n("div",null,[n("h3",Te,p(t.project.title),1),n("p",Fe,p(t.project.short_description||t.project.description),1)]),n("div",Ie,[(u(!0),N(G,null,H((F=t.project.technologies)==null?void 0:F.slice(0,3),B=>(u(),x(c(P),{key:B.id,class:"text-xs bg-gray-100 dark:bg-white/10 hover:bg-blue-500/25 dark:hover:bg-blue-400/50 text-gray-700 dark:text-white border border-gray-200 dark:border-white/10"},{default:f(()=>[b(p(B.name),1)]),_:2},1024))),128)),((I=t.project.technologies)==null?void 0:I.length)>3?(u(),x(c(P),{key:0,class:"text-xs bg-gray-100 dark:bg-white/10 hover:bg-blue-500/25 dark:hover:bg-blue-400/50 text-gray-700 dark:text-white border border-gray-200 dark:border-white/10"},{default:f(()=>[b(" +"+p(t.project.technologies.length-3),1)]),_:1})):S("",!0),(z=t.project.technologies)!=null&&z.length?S("",!0):(u(),x(c(P),{key:1,class:"text-xs bg-gray-100 dark:bg-white/10 hover:bg-blue-500/25 dark:hover:bg-blue-400/50 text-gray-700 dark:text-white border border-gray-200 dark:border-white/10"},{default:f(()=>[...s[3]||(s[3]=[b(" No technologies added ",-1)])]),_:1}))]),t.showActions?(u(),N("div",ze,[n("div",Ee,[n("button",{onClick:Y(i,["stop"]),class:L(["flex items-center gap-1 transition-colors",t.project.is_upvoted_by_user?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"])},[g(c(he),{class:"w-4 h-4"}),n("span",null,p(t.project.upvotes_count||0),1)],2),n("button",{onClick:Y(K,["stop"]),class:"flex items-center gap-1 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors"},[g(c(ue),{class:"w-4 h-4"}),s[4]||(s[4]=n("span",null,"Share",-1))]),n("div",Be,[g(c(be),{class:"w-4 h-4 text-green-600 dark:text-green-400"}),n("span",null,p(((E=t.project.views)==null?void 0:E.toLocaleString())||0),1)])]),g(c(de),{size:"sm",class:"bg-gradient-to-r from-blue-400 via-purple-400 to-indigo-400 hover:from-blue-500 hover:via-purple-500 hover:to-indigo-500 transition-all duration-300 text-white shadow-lg shadow-blue-400/30",onClick:Y(C,["stop"])},{default:f(()=>[b(p(t.project.is_sellable&&t.project.selling_price?`Buy for $${t.project.selling_price}`:"View Project")+" ",1),g(c(je),{class:"w-4 h-4 ml-2"})]),_:1})])):S("",!0)]}),_:1})]),_:1},8,["class"]))}},Ve=le(Re,[["__scopeId","data-v-1c703183"]]),Qe={key:0,class:"min-h-[40vh] flex flex-col items-center justify-center gap-3 text-center text-gray-500 dark:text-gray-300"},Ue={class:"text-sm font-medium"},at={__name:"InfiniteScroll",props:{fetchKey:{type:[Number,String,null],default:null},username:{type:[String,null],default:null},scrolling:{type:String,default:"post"},filters:{type:Object,default:()=>({})},perPage:{type:Number,default:12},userId:{type:Number,default:null}},emits:["share_url"],setup(t,{emit:U}){const e=t,A=U,j=Z(),_=w(null),k=w(null),y=w(1),i=w([]),h=w(!1),K=w(1),C=w(!1),m=w(!0),M=v(()=>e.scrolling==="post"?fe:e.scrolling==="qna"?me:Ve),O=v(()=>e.scrolling==="post"?"post":e.scrolling==="qna"?"question":"project"),r=()=>{y.value=1,i.value=[],C.value=!1,m.value=!0,k.value=null},s=()=>{r(),q()};async function d(){var W,J;const o={page:y.value,per_page:e.perPage||10,...e.username&&{username:e.username},...((W=e.filters)==null?void 0:W.sort)&&{sort:e.filters.sort},...((J=e.filters)==null?void 0:J.tags)&&{tags:Array.isArray(e.filters.tags)?e.filters.tags.join(","):e.filters.tags}},a=await Q.get("/api/v1/posts",{params:o,...j.isAuthenticated?j.config:{}}),l=a.data.records||a.data,D=l.data||[];i.value.push(...D),k.value=D.length,_.value={page:l.current_page||y.value,pageSize:l.per_page||e.perPage,pageCount:l.last_page||1,total:l.total||0},m.value=_.value.page<_.value.pageCount,D.length===0&&(m.value=!1)}async function $(){const o=`/api/v1/questions-feed?page=${y.value}`,a=await Q.post(o,{username:e.username},j.config),l=a.data.records.data;i.value.push(...l),k.value=l.length,_.value={page:a.data.records.current_page,pageSize:a.data.records.per_page,pageCount:a.data.records.last_page,total:a.data.records.total},l.length===0&&(m.value=!1)}async function T(){const o={page:y.value,per_page:e.perPage,...e.filters};e.userId&&(o.user_id=e.userId);const a=await Q.get("/api/v1/projects",{params:o,...j.isAuthenticated?j.config:{}}),l=a.data.data||[];i.value.push(...l),k.value=l.length,_.value={page:a.data.current_page,pageSize:a.data.per_page,pageCount:a.data.last_page,total:a.data.total},m.value=a.data.current_page<a.data.last_page,m.value&&(y.value=a.data.current_page+1)}const q=async()=>{if(!(h.value||!m.value)){h.value=!0;try{e.scrolling==="project"?await T():e.scrolling==="post"?await d():e.scrolling==="qna"&&await $()}catch(o){console.error("Error fetching records:",o),m.value=!1}finally{h.value=!1,C.value=!0}}},F=o=>{i.value=i.value.filter(a=>a.post_code!==o)},I=o=>{i.value=i.value.filter(a=>a.slug!==o)},z=o=>{if(e.scrolling!=="project")return;const a=i.value.findIndex(l=>l.id===o.id);a!==-1&&(i.value[a]={...o})},E=()=>{h.value||(e.scrolling!=="project"&&y.value++,q())},B=o=>{A("share_url",o)},ee=async o=>{i.value.find((a,l)=>{a.post_code===o[0]&&(i.value[l].liked=o[1],o[1]?i.value[l].likes_count++:i.value[l].likes_count--)})},te=v(()=>e.scrolling==="project"?"w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 pb-5":"max-w-2xl mx-auto flex flex-col gap-4 sm:px-6 pb-5"),ae=v(()=>{switch(e.scrolling){case"post":return"h-[400px]";case"qna":return"h-[250px]";case"project":return"h-[600px]"}}),re=v(()=>{switch(e.scrolling){case"post":return 5;case"qna":return 5;case"project":return 6}}),se=v(()=>h.value&&!C.value),oe=v(()=>{switch(e.scrolling){case"post":return"Fetching posts...";case"qna":return"Fetching questions...";case"project":return"Fetching projects...";default:return"Loading content..."}});return q(),V(()=>e.fetchKey,()=>{s()}),V(()=>e.filters,()=>{s()},{deep:!0}),V(()=>e.userId,()=>{s()}),V(()=>e.perPage,()=>{s()}),(o,a)=>(u(),N("div",null,[se.value?(u(),N("div",Qe,[g(Ce,{size:"lg"}),n("p",Ue,p(oe.value),1)])):(u(),N("div",{key:1,class:L([te.value,"infinite-scroll-container"])},[g(X,{name:"fade",appear:""},{default:f(()=>[(u(!0),N(G,null,H(i.value,(l,D)=>(u(),x(ge(M.value),pe({key:D,onShare_url:B,onFetch:s,onLiked_action:ee,onDelete_post:F,onDelete_question:I,onLoad_more:E,onUpvoted:z,class:D===i.value.length-K.value?"last_item":""},{ref_for:!0},{[O.value]:l}),null,16,["class"]))),128))]),_:1}),h.value?(u(),x(X,{key:0,name:"fade"},{default:f(()=>[(u(!0),N(G,null,H(re.value,l=>(u(),x(c(_e),{key:l,class:L(["w-full rounded-2xl",ae.value])},null,8,["class"]))),128))]),_:1})):S("",!0),!h.value&&C.value&&i.value.length===0?(u(),x(ke,{key:1,icon:"FileText",title:t.scrolling==="post"?"No Posts Yet":t.scrolling==="qna"?"No Questions Yet":"No Projects Yet",subtitle:t.scrolling==="post"?"This user hasn't posted anything yet.":t.scrolling==="qna"?"This user hasn't asked any questions yet.":"No projects match your criteria.",size:"small"},null,8,["title","subtitle"])):S("",!0)],2))]))}};export{at as _};
//# sourceMappingURL=InfiniteScroll-DLzqwnpV.js.map
