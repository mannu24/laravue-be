import{aS as A,p as k,a as h,at as d,aT as f,j as S,aq as _}from"./app-DI7wrdgO.js";const C=A("task",()=>{const t=k(!1),s=k(null),u=k([]),i=k([]),m=h(()=>u.value),w=h(()=>i.value),n=async r=>{var a,l;try{t.value=!0,s.value=null;const e=await d.get(f.tasks.daily(r));return u.value=e.data.data,e.data.data}catch(e){throw s.value=((l=(a=e.response)==null?void 0:a.data)==null?void 0:l.message)||"Failed to fetch daily tasks",e}finally{t.value=!1}},o=async r=>{var a,l;try{t.value=!0,s.value=null;const e=await d.get(f.tasks.weekly(r));return i.value=e.data.data,e.data.data}catch(e){throw s.value=((l=(a=e.response)==null?void 0:a.data)==null?void 0:l.message)||"Failed to fetch weekly tasks",e}finally{t.value=!1}};return{loading:t,error:s,dailyTasks:u,weeklyTasks:i,todayTasks:m,weekTasks:w,fetchDailyTasks:n,fetchWeeklyTasks:o,completeTask:async(r,a)=>{var l,e;try{t.value=!0,s.value=null;const c=await d.post(f.tasks.complete(),{task_id:r,user_id:a});return await n(a),await o(a),c.data.data}catch(c){throw s.value=((e=(l=c.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to complete task",c}finally{t.value=!1}},assignTask:async(r,a)=>{var l,e;try{t.value=!0,s.value=null;const c=await d.post(f.tasks.assign(),{task_id:r,user_id:a});return await n(a),await o(a),c.data.data}catch(c){throw s.value=((e=(l=c.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to assign task",c}finally{t.value=!1}},clearTasks:()=>{u.value=[],i.value=[],s.value=null}}}),g={"questions.ask":"Ask 1 Question","questions.index":null,"tasks.index":null,question_created:"Ask 1 Question",answer_created:"Answer 1 Question"},T=k(new Set);function B(){const t=S(),s=_();C();const u=async(n,o=!1)=>{var y,v,r;if(!t.isAuthenticated||!((y=t.user)!=null&&y.id))return!1;const p=`${n}-${new Date().toDateString()}`;if(T.value.has(p))return!1;try{const a=await d.post(f.tasks.autoComplete(),{task_title:n});if(a.data.success){const l=a.data.data;return T.value.add(p),await s.fetchGlobalData({force:!0}),!0}}catch(a){return console.debug("[AutoTask] Task completion failed:",((r=(v=a.response)==null?void 0:v.data)==null?void 0:r.message)||a.message),!1}return!1};return{completeTaskByTitle:u,completeTaskByRoute:async n=>{const o=g[n];return o?await u(o,!1):!1},completeTaskByAction:async n=>{const o=g[n];return o?await u(o,!1):!1},clearCompletedCache:()=>{T.value.clear()}}}export{B as useAutoTaskCompletion};
//# sourceMappingURL=useAutoTaskCompletion-B0y9nFtT.js.map
