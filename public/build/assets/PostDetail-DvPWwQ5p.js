import{_ as z,p as L,j as B,k as F,U as M,b as c,o as d,d as n,D as t,w as i,G as y,u as l,x as T,H as k,A as S,z as E,aA as N,aB as U,aC as H,aD as I,aE as G,aF as R,aG as q,aH as K,T as J,I as A,a as j,F as V,E as O,f as Q,at as W,K as X,aa as Y,C as P,R as Z,l as ee,q as te}from"./app-Bvnl7d0n.js";import{a as se}from"./PostCard-6SO9_3tv.js";import{E as oe,_ as ae}from"./useBookmark-MdNZIhAe.js";import{_ as ne}from"./BackNavigator-W4HPAldQ.js";import{L as re}from"./LoadingSpinner-ekVe37eh.js";import"./DialogContent-QiX1Bk05.js";import"./Card-hOl-Usuy.js";import"./CardContent-BNEtnmat.js";import"./bookmark-Afub3nbE.js";import"./chevron-right-Cq0N1iJW.js";const le={class:"flex items-start gap-2 py-1.5 group"},ie=["src"],de={class:"flex-1 min-w-0"},me={class:"flex items-start justify-between gap-2"},ce={class:"flex-1 min-w-0"},ue={class:"inline-flex items-baseline gap-1.5 flex-wrap"},fe=["innerHTML"],ge={class:"flex items-center gap-4 mt-1 text-xs text-gray-500 dark:text-gray-400"},pe={class:"text-xs"},ve={__name:"CommentCard",props:["comment"],emits:["commentDeleted","commentLiked"],setup(o,{emit:w}){const p=L(!1),g=B(),u=F(),f=w,s=async()=>{if(!g.isAuthenticated)u.push("/login");else{const r=await A.get(`/api/v1/comment/like-unlike/${o.comment.id}`,g.config);r.data.status=="success"?f("commentLiked",[o.comment.id,r.data.liked]):alert("Something went wrong")}},x=async()=>{p.value=!1,await A.delete(`/api/v1/post/comment/${o.comment.id}`,g.config).then(()=>{f("commentDeleted",o.comment.id)})},$=r=>r.replace(/@(\w+)/g,'<a href="/@$1" class="mention-link">@$1</a>'),b=r=>{r.target.src="/assets/front/images/user.png"};return(r,e)=>{var v,_;const h=M("router-link");return d(),c("div",le,[n(h,{to:o.comment.user.username!=((v=l(g).user)==null?void 0:v.username)?"/@"+o.comment.user.username:"/dashboard",onClick:e[0]||(e[0]=y(()=>{},["stop"])),class:"flex-shrink-0"},{default:i(()=>{var C,D;return[(C=o.comment.user)!=null&&C.profile_photo?(d(),c("img",{key:0,src:(D=o.comment.user)==null?void 0:D.profile_photo,alt:"User Avatar",class:"w-6 h-6 rounded-full object-cover",onError:b},null,40,ie)):(d(),c("img",{key:1,src:"/assets/front/images/user.png",alt:"User Avatar",class:"w-6 h-6 rounded-full object-cover",onError:b},null,32))]}),_:1},8,["to"]),t("div",de,[t("div",me,[t("div",ce,[t("div",ue,[n(h,{onClick:e[1]||(e[1]=y(()=>{},["stop"])),to:o.comment.user.username!=((_=l(g).user)==null?void 0:_.username)?"/@"+o.comment.user.username:"/dashboard",class:"font-semibold text-sm text-gray-900 dark:text-gray-100 hover:underline"},{default:i(()=>[k(S(o.comment.user.name),1)]),_:1},8,["to"]),t("span",{class:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-wrap break-words",innerHTML:$(o.comment.content),onClick:e[2]||(e[2]=y(()=>{},["stop"]))},null,8,fe)]),t("div",ge,[t("span",pe,S(o.comment.posted_at),1),t("button",{class:E(["font-semibold hover:underline flex items-center gap-1",o.comment.liked?"text-red-600 dark:text-red-400":""]),onClick:y(s,["stop"])},[t("i",{class:E([o.comment.liked?"fas fa-heart":"far fa-heart","text-xs"])},null,2),t("span",null,S(o.comment.likes_count>0?o.comment.likes_count:"Like"),1)],2)])]),l(g).isAuthenticated&&o.comment.owner?(d(),c("div",{key:0,class:"relative flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:e[6]||(e[6]=y(()=>{},["stop"]))},[t("button",{onClick:e[3]||(e[3]=C=>p.value=!p.value),class:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700/60 text-gray-500 dark:text-gray-400"},[n(l(oe),{class:"w-4 h-4"})]),n(J,{name:"fade"},{default:i(()=>[p.value?(d(),c("div",{key:0,onClick:e[5]||(e[5]=y(()=>{},["stop"])),class:"absolute right-0 top-full mt-1 z-20 w-32 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",role:"menu","aria-orientation":"vertical"},[n(l(N),null,{default:i(()=>[n(l(ae),{"as-child":""},{default:i(()=>[t("button",{onClick:e[4]||(e[4]=y(()=>{},["stop"])),class:"w-full text-left px-3 py-2 text-xs flex items-center gap-2 hover:bg-red-50 dark:hover:bg-red-900/30 text-red-600 dark:text-red-400"},[...e[7]||(e[7]=[t("i",{class:"fas fa-trash text-xs"},null,-1),k(" Delete ",-1)])])]),_:1}),n(l(U),null,{default:i(()=>[n(l(H),null,{default:i(()=>[n(l(I),null,{default:i(()=>[...e[8]||(e[8]=[k("Are you absolutely sure?",-1)])]),_:1}),n(l(G),null,{default:i(()=>[...e[9]||(e[9]=[k(" This action cannot be undone. This will delete your comment. ",-1)])]),_:1})]),_:1}),n(l(R),null,{default:i(()=>[n(l(q),null,{default:i(()=>[...e[10]||(e[10]=[k("Cancel",-1)])]),_:1}),n(l(K),{onClick:y(x,["stop"])},{default:i(()=>[...e[11]||(e[11]=[k("Continue",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])):T("",!0)]),_:1})])):T("",!0)])])])}}},ye=z(ve,[["__scopeId","data-v-ddb8af96"]]),ke={class:"bg-card border border-gray-200 dark:border-gray-800 rounded-lg shadow-sm space-y-5 p-5"},xe={class:"flex items-center justify-between border-b border-gray-200 dark:border-gray-700 pb-4"},he={class:"text-sm text-gray-500 dark:text-gray-400"},be={class:"space-y-3"},_e={key:0,class:"text-sm text-gray-500 dark:text-gray-400 text-center py-8 border rounded-lg border-dashed border-gray-200 dark:border-gray-700"},we={class:"pt-3 mt-3 border-t border-gray-200 dark:border-gray-700"},$e={class:"flex items-center justify-end gap-3"},Ce={key:0},Le={key:1,class:"flex items-center gap-2"},De={__name:"CommentSection",props:["comments","post_code"],emits:["commentAdded","commentDeleted","commentLiked"],setup(o,{emit:w}){const p=w,g=B(),u=L(""),f=L(!1),s=j(()=>(o.comments||[]).length>0),x=r=>{p("commentDeleted",r)},$=r=>{p("commentLiked",r)},b=async()=>{if(!(!u.value.trim()||f.value))try{f.value=!0;const r=await A.post("/api/v1/post/comment",{code:o.post_code,content:u.value.trim()},g.config);r.data.status==="success"&&(u.value="",p("commentAdded",r.data.comment))}finally{f.value=!1}};return(r,e)=>{var h;return d(),c("section",ke,[t("div",xe,[e[2]||(e[2]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Comments",-1)),t("span",he,S(((h=o.comments)==null?void 0:h.length)||0)+" total",1)]),t("div",be,[n(W,{name:"fade",appear:""},{default:i(()=>[(d(!0),c(V,null,O(o.comments,(v,_)=>(d(),Q(ye,{key:_,onCommentLiked:$,onCommentDeleted:x,comment:v},null,8,["comment"]))),128))]),_:1}),s.value?T("",!0):(d(),c("p",_e," No comments yet. Be the first to share your thoughts! "))]),t("div",we,[t("form",{onSubmit:y(b,["prevent"]),class:"space-y-3"},[X(t("textarea",{rows:"3",required:"","onUpdate:modelValue":e[0]||(e[0]=v=>u.value=v),placeholder:"Share your thoughts...",class:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder:text-gray-400 dark:placeholder:text-gray-400 px-4 py-3 text-sm transition-all duration-200 focus:outline-none focus:border-green-500 dark:focus:border-green-500 hover:border-gray-400 dark:hover:border-gray-500 resize-none"},null,512),[[Y,u.value]]),t("div",$e,[n(l(P),{type:"button",variant:"outline",size:"sm",onClick:e[1]||(e[1]=v=>u.value=""),disabled:!u.value.length||f.value},{default:i(()=>[...e[3]||(e[3]=[k(" Clear ",-1)])]),_:1},8,["disabled"]),n(l(P),{type:"submit",size:"sm",class:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 text-white shadow-md",disabled:f.value||!u.value.length},{default:i(()=>[f.value?(d(),c("span",Le,[...e[4]||(e[4]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),k(" Postingâ€¦ ",-1)])])):(d(),c("span",Ce,"Post"))]),_:1},8,["disabled"])])],32)])])}}},Se=z(De,[["__scopeId","data-v-1a0e9c09"]]),Ae={class:"max-w-7xl mx-auto py-5 min-h-[60vh]"},Te={key:0,class:"min-h-[60vh] flex flex-col items-center justify-center text-center gap-3"},je={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Be={class:"lg:col-span-2 lg:sticky lg:top-8 lg:self-start"},Ee={class:"lg:col-span-1"},Pe={key:2,class:"min-h-[60vh] flex flex-col items-center justify-center text-center gap-3"},Ke={__name:"PostDetail",emits:["share_url"],setup(o,{emit:w}){const p=Z(),g=F(),u=B(),f=j(()=>p.params.post_code),s=L(null),x=L(!0),$=w,b=j(()=>s.value?[{name:"Feed",href:"/feed"},{name:s.value.title||s.value.post_code||"Post",href:`/feed/${s.value.post_code}`}]:[{name:"Feed",href:"/feed"}]),r=async()=>{x.value=!0;try{const a=await A.get(`/api/v1/posts/post_${f.value}`,u.config);s.value=a.data}catch(a){console.error("Error fetching post:",a),s.value=null}finally{x.value=!1}},e=a=>{$("share_url",a)},h=a=>{g.push("/feed")},v=async a=>{s.value.liked=a[1],a[1]?s.value.likes_count++:s.value.likes_count--},_=async a=>{s.value.comments.find(m=>m.id==a[0]).liked=a[1],a[1]?s.value.comments.find(m=>m.id==a[0]).likes_count++:s.value.comments.find(m=>m.id==a[0]).likes_count--},C=a=>{s.value.comments=s.value.comments.filter(m=>m.id!==a),s.value.comments_count--},D=a=>{s.value.comments.push(a),s.value.comments_count++};return ee(f,()=>{r()}),te(r),(a,m)=>(d(),c("div",Ae,[x.value?(d(),c("div",Te,[n(re,{size:"lg"}),m[1]||(m[1]=t("p",{class:"text-gray-600 dark:text-gray-300"},"Loading post...",-1))])):s.value?(d(),c(V,{key:1},[n(ne,{items:b.value},null,8,["items"]),t("div",je,[t("div",Be,[n(se,{onShare_url:e,onLiked_action:v,onDelete_post:h,post:s.value},null,8,["post"])]),t("div",Ee,[n(Se,{onCommentLiked:_,onCommentDeleted:C,onCommentAdded:D,type:"post",post_code:s.value.post_code,comments:s.value.comments},null,8,["post_code","comments"])])])],64)):(d(),c("div",Pe,[m[2]||(m[2]=t("p",{class:"text-gray-600 dark:text-gray-300"},"Post not found or unavailable.",-1)),t("button",{class:"text-vue hover:text-laravel transition-colors underline",onClick:m[0]||(m[0]=ze=>l(g).push("/feed"))}," Back to Feed ")]))]))}};export{Ke as default};
//# sourceMappingURL=PostDetail-DvPWwQ5p.js.map
