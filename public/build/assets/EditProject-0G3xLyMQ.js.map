{"version":3,"file":"EditProject-0G3xLyMQ.js","sources":["../../../resources/js/views/EditProject.vue"],"sourcesContent":["<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { useThemeStore } from '../stores/theme'\r\nimport { useAuthStore } from '../stores/auth'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport ProjectForm from '@/components/projects/ProjectForm.vue'\r\nimport { ArrowLeft, Code2 } from 'lucide-vue-next'\r\nimport axios from 'axios'\r\nimport { toast } from '@/components/ui/toast'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst themeStore = useThemeStore()\r\nconst authStore = useAuthStore()\r\n\r\nconst loading = ref(false)\r\nconst project = ref(null)\r\nconst formErrors = ref({})\r\n\r\n// Fetch project data\r\nconst fetchProject = async () => {\r\n  loading.value = true\r\n  try {\r\n    const response = await axios.get(`/api/v1/projects/${route.params.slug}`, authStore.config)\r\n    project.value = response.data.data\r\n  } catch (error) {\r\n    console.error('Error fetching project:', error)\r\n    toast({\r\n      title: \"Error\",\r\n      description: \"Failed to load project\",\r\n      variant: \"destructive\"\r\n    })\r\n    router.push(`/projects/${route.params.slug}`)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst handleSubmit = async (formData) => {\r\n  loading.value = true\r\n  formErrors.value = {}\r\n\r\n  try {\r\n    const data = new FormData()\r\n\r\n    // Basic fields\r\n    data.append('title', formData.title)\r\n    data.append('description', formData.description)\r\n    data.append('project_type', formData.project_type)\r\n    data.append('is_sellable', formData.is_sellable ? 1 : 0)\r\n\r\n    // Optional fields\r\n    if (formData.short_description) data.append('short_description', formData.short_description)\r\n    if (formData.excerpt) data.append('excerpt', formData.excerpt)\r\n    if (formData.github_url) data.append('github_url', formData.github_url)\r\n    if (formData.demo_url) data.append('demo_url', formData.demo_url)\r\n    if (formData.category_id) data.append('category_id', formData.category_id)\r\n    if (formData.difficulty_level) data.append('difficulty_level', formData.difficulty_level)\r\n    if (formData.industry) data.append('industry', formData.industry)\r\n    if (formData.currency) data.append('currency', formData.currency)\r\n\r\n    // Pricing\r\n    if (formData.is_sellable) {\r\n      data.append('original_price', formData.original_price)\r\n      data.append('selling_price', formData.selling_price)\r\n      if (formData.discount_percentage) data.append('discount_percentage', formData.discount_percentage)\r\n      if (formData.discount_start_date) data.append('discount_start_date', formData.discount_start_date)\r\n      if (formData.discount_end_date) data.append('discount_end_date', formData.discount_end_date)\r\n      if (formData.stock_quantity) data.append('stock_quantity', formData.stock_quantity)\r\n      data.append('is_digital', formData.is_digital ? 1 : 0)\r\n    }\r\n\r\n    // Technologies\r\n    if (formData.technologies && formData.technologies.length > 0) {\r\n      formData.technologies.forEach(tech => {\r\n        data.append('technologies[]', tech.name || tech)\r\n      })\r\n    }\r\n\r\n    // Featured image (only if new one is uploaded)\r\n    if (formData.featured_image) {\r\n      data.append('featured_image', formData.featured_image)\r\n    }\r\n\r\n    // Use PUT method for update\r\n    data.append('_method', 'PUT')\r\n\r\n    const response = await axios.post(`/api/v1/projects/${route.params.slug}`, data, {\r\n      ...authStore.config,\r\n      headers: {\r\n        ...authStore.config.headers,\r\n        'Content-Type': 'multipart/form-data'\r\n      }\r\n    })\r\n\r\n    toast({\r\n      title: \"Success\",\r\n      description: \"Project updated successfully!\",\r\n    })\r\n\r\n    router.push(`/projects/${route.params.slug}`)\r\n\r\n  } catch (error) {\r\n    console.error('Error updating project:', error)\r\n\r\n    if (error.response?.data?.errors) {\r\n      formErrors.value = error.response.data.errors\r\n    }\r\n\r\n    toast({\r\n      title: \"Error\",\r\n      description: error.response?.data?.message || \"Failed to update project\",\r\n      variant: \"destructive\"\r\n    })\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst handleCancel = () => {\r\n  router.push(`/projects/${route.params.slug}`)\r\n}\r\n\r\nonMounted(() => {\r\n  fetchProject()\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"min-h-screen\">\r\n    <div class=\"container mx-auto px-4 py-8 sm:px-6 lg:px-8\">\r\n      <!-- Header -->\r\n      <div class=\"mb-8\">\r\n        <Button\r\n          variant=\"ghost\"\r\n          class=\"mb-4\"\r\n          @click=\"handleCancel\"\r\n        >\r\n          <ArrowLeft class=\"h-4 w-4 mr-2\" />\r\n          Back\r\n        </Button>\r\n\r\n        <div class=\"text-center\">\r\n          <h1 class=\"text-4xl font-bold mb-4\" :class=\"themeStore.isDark ? 'text-white' : 'text-gray-900'\">\r\n            Edit Project\r\n          </h1>\r\n          <p class=\"text-lg\" :class=\"themeStore.isDark ? 'text-gray-300' : 'text-gray-600'\">\r\n            Update your project information\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Loading State -->\r\n      <div v-if=\"loading && !project\" class=\"max-w-4xl mx-auto\">\r\n        <Card :class=\"['border-0 shadow-xl',\r\n          themeStore.isDark ? 'bg-gray-800' : 'bg-white'\r\n        ]\">\r\n          <CardContent class=\"p-12 text-center\">\r\n            <div class=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto\"></div>\r\n            <p class=\"mt-4\" :class=\"themeStore.isDark ? 'text-gray-300' : 'text-gray-600'\">\r\n              Loading project...\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <!-- Form -->\r\n      <div v-else-if=\"project\" class=\"max-w-4xl mx-auto\">\r\n        <ProjectForm\r\n          :project=\"project\"\r\n          :loading=\"loading\"\r\n          submit-label=\"Update Project\"\r\n          @submit=\"handleSubmit\"\r\n          @cancel=\"handleCancel\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n"],"names":["route","useRoute","router","useRouter","themeStore","useThemeStore","authStore","useAuthStore","loading","ref","project","formErrors","fetchProject","response","axios","error","toast","handleSubmit","formData","data","tech","_b","_a","_d","_c","handleCancel","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_unref","Button","ArrowLeft","_hoisted_4","_normalizeClass","_hoisted_5","Card","CardContent","_hoisted_6","ProjectForm"],"mappings":"6pCAYA,MAAMA,EAAQC,EAAQ,EAChBC,EAASC,EAAS,EAClBC,EAAaC,EAAa,EAC1BC,EAAYC,EAAY,EAExBC,EAAUC,EAAI,EAAK,EACnBC,EAAUD,EAAI,IAAI,EAClBE,EAAaF,EAAI,EAAE,EAGnBG,EAAe,SAAY,CAC/BJ,EAAQ,MAAQ,GAChB,GAAI,CACF,MAAMK,EAAW,MAAMC,EAAM,IAAI,oBAAoBd,EAAM,OAAO,IAAI,GAAIM,EAAU,MAAM,EAC1FI,EAAQ,MAAQG,EAAS,KAAK,IAChC,OAASE,EAAO,CACd,QAAQ,MAAM,0BAA2BA,CAAK,EAC9CC,EAAM,CACJ,MAAO,QACP,YAAa,yBACb,QAAS,aACf,CAAK,EACDd,EAAO,KAAK,aAAaF,EAAM,OAAO,IAAI,EAAE,CAC9C,QAAC,CACCQ,EAAQ,MAAQ,EAClB,CACF,EAEMS,EAAe,MAAOC,GAAa,aACvCV,EAAQ,MAAQ,GAChBG,EAAW,MAAQ,CAAA,EAEnB,GAAI,CACF,MAAMQ,EAAO,IAAI,SAGjBA,EAAK,OAAO,QAASD,EAAS,KAAK,EACnCC,EAAK,OAAO,cAAeD,EAAS,WAAW,EAC/CC,EAAK,OAAO,eAAgBD,EAAS,YAAY,EACjDC,EAAK,OAAO,cAAeD,EAAS,YAAc,EAAI,CAAC,EAGnDA,EAAS,mBAAmBC,EAAK,OAAO,oBAAqBD,EAAS,iBAAiB,EACvFA,EAAS,SAASC,EAAK,OAAO,UAAWD,EAAS,OAAO,EACzDA,EAAS,YAAYC,EAAK,OAAO,aAAcD,EAAS,UAAU,EAClEA,EAAS,UAAUC,EAAK,OAAO,WAAYD,EAAS,QAAQ,EAC5DA,EAAS,aAAaC,EAAK,OAAO,cAAeD,EAAS,WAAW,EACrEA,EAAS,kBAAkBC,EAAK,OAAO,mBAAoBD,EAAS,gBAAgB,EACpFA,EAAS,UAAUC,EAAK,OAAO,WAAYD,EAAS,QAAQ,EAC5DA,EAAS,UAAUC,EAAK,OAAO,WAAYD,EAAS,QAAQ,EAG5DA,EAAS,cACXC,EAAK,OAAO,iBAAkBD,EAAS,cAAc,EACrDC,EAAK,OAAO,gBAAiBD,EAAS,aAAa,EAC/CA,EAAS,qBAAqBC,EAAK,OAAO,sBAAuBD,EAAS,mBAAmB,EAC7FA,EAAS,qBAAqBC,EAAK,OAAO,sBAAuBD,EAAS,mBAAmB,EAC7FA,EAAS,mBAAmBC,EAAK,OAAO,oBAAqBD,EAAS,iBAAiB,EACvFA,EAAS,gBAAgBC,EAAK,OAAO,iBAAkBD,EAAS,cAAc,EAClFC,EAAK,OAAO,aAAcD,EAAS,WAAa,EAAI,CAAC,GAInDA,EAAS,cAAgBA,EAAS,aAAa,OAAS,GAC1DA,EAAS,aAAa,QAAQE,GAAQ,CACpCD,EAAK,OAAO,iBAAkBC,EAAK,MAAQA,CAAI,CACjD,CAAC,EAICF,EAAS,gBACXC,EAAK,OAAO,iBAAkBD,EAAS,cAAc,EAIvDC,EAAK,OAAO,UAAW,KAAK,EAE5B,MAAMN,EAAW,MAAMC,EAAM,KAAK,oBAAoBd,EAAM,OAAO,IAAI,GAAImB,EAAM,CAC/E,GAAGb,EAAU,OACb,QAAS,CACP,GAAGA,EAAU,OAAO,QACpB,eAAgB,qBACxB,CACA,CAAK,EAEDU,EAAM,CACJ,MAAO,UACP,YAAa,+BACnB,CAAK,EAEDd,EAAO,KAAK,aAAaF,EAAM,OAAO,IAAI,EAAE,CAE9C,OAASe,EAAO,CACd,QAAQ,MAAM,0BAA2BA,CAAK,GAE1CM,GAAAC,EAAAP,EAAM,WAAN,YAAAO,EAAgB,OAAhB,MAAAD,EAAsB,SACxBV,EAAW,MAAQI,EAAM,SAAS,KAAK,QAGzCC,EAAM,CACJ,MAAO,QACP,cAAaO,GAAAC,EAAAT,EAAM,WAAN,YAAAS,EAAgB,OAAhB,YAAAD,EAAsB,UAAW,2BAC9C,QAAS,aACf,CAAK,CACH,QAAC,CACCf,EAAQ,MAAQ,EAClB,CACF,EAEMiB,EAAe,IAAM,CACzBvB,EAAO,KAAK,aAAaF,EAAM,OAAO,IAAI,EAAE,CAC9C,EAEA,OAAA0B,EAAU,IAAM,CACdd,EAAY,CACd,CAAC,UAICe,EAAA,EAAAC,EAgDM,MAhDNC,EAgDM,CA/CJC,EA8CM,MA9CNC,EA8CM,CA5CJD,EAkBM,MAlBNE,EAkBM,CAjBJC,EAOSC,EAAAC,CAAA,EAAA,CANP,QAAQ,QACR,MAAM,OACL,QAAOV,cAER,IAAkC,CAAlCQ,EAAkCC,EAAAE,CAAA,EAAA,CAAvB,MAAM,cAAc,CAAA,gBAAG,SAEpC,EAAA,WAEAN,EAOM,MAPNO,EAOM,CANJP,EAEK,KAAA,CAFD,MAAKQ,EAAA,CAAC,0BAAkCJ,EAAA9B,CAAA,EAAW,OAAM,aAAA,eAAA,CAAA,GAAmC,iBAEhG,CAAA,EACA0B,EAEI,IAAA,CAFD,MAAKQ,EAAA,CAAC,UAAkBJ,EAAA9B,CAAA,EAAW,OAAM,gBAAA,eAAA,CAAA,GAAsC,oCAElF,CAAA,MAKOI,EAAA,QAAYE,EAAA,OAAvBiB,IAAAC,EAWM,MAXNW,EAWM,CAVJN,EASOC,EAAAM,CAAA,EAAA,CATA,MAAKF,EAAA,CAAA,qBAAoCJ,EAAA9B,CAAA,EAAW,OAAM,cAAA,yBAG/D,IAKc,CALd6B,EAKcC,EAAAO,CAAA,EAAA,CALD,MAAM,kBAAkB,EAAA,WACnC,IAA0F,aAA1FX,EAA0F,MAAA,CAArF,MAAM,wEAAwE,EAAA,KAAA,EAAA,GACnFA,EAEI,IAAA,CAFD,MAAKQ,EAAA,CAAC,OAAeJ,EAAA9B,CAAA,EAAW,OAAM,gBAAA,eAAA,CAAA,GAAsC,uBAE/E,CAAA,iCAMUM,EAAA,OAAhBiB,IAAAC,EAQM,MARNc,EAQM,CAPJT,EAMEU,EAAA,CALC,QAASjC,EAAA,MACT,QAASF,EAAA,MACV,eAAa,iBACZ,SAAQS,EACR,SAAQQ"}