import{c as L,_ as ie,j as ce,t as ue,p as b,a as J,q as de,k as ge,a6 as ve,l as fe,b as p,D as o,d as c,x as v,z as d,u as a,A as h,f as m,w as f,H as N,C as _,F as I,E as P,ar as he,T as pe,I as C,o as l,G as B}from"./app-BusCMfsw.js";import{_ as Y}from"./Card-rloiMM0U.js";import{_ as K}from"./CardContent-DRH463jB.js";import{_ as A}from"./Skeleton-l3cOuYxv.js";import{_ as be}from"./EmptyState-NxnJnIdz.js";import{_ as me}from"./ConfirmDialog-C7h6FdHb.js";import{T as Q}from"./trash-2-Czg8HS1a.js";import{C as W}from"./check-CUNbtvTk.js";import"./folder-open-B70ERHKg.js";import"./activity-DQPhffiL.js";import"./bookmark-DBYfvgfa.js";import"./code-xml-Bho0_5ph.js";import"./file-text-CCni2WtV.js";import"./search-D7HZvnyK.js";import"./AlertDialogTitle-CaEIQJxU.js";/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=L("CheckCheckIcon",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=L("SquareCheckIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=L("SquareIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),_e={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},we={class:"flex items-center justify-between mb-8"},De={key:0},Ce={key:1},Se={class:"flex items-center gap-2"},Ne={class:"flex items-center justify-between"},$e={class:"notifications-container space-y-3"},qe={class:"flex items-start gap-4"},Ae=["onClick"],Me={class:"flex-1 min-w-0"},ze={class:"flex items-start justify-between gap-3 mb-2"},Ee={class:"flex-1"},Te={key:0,class:"flex items-center gap-2 flex-shrink-0"},je={class:"flex items-center justify-between"},Ie={key:0,class:"space-y-3"},Be={class:"flex items-start gap-4"},Le={class:"flex-1 space-y-2"},Ue={key:1,class:"text-center py-8"},Oe={__name:"Notifications",setup(Re){const y=ce(),r=ue(),U=ge(),i=b([]),w=b(!1),$=b(1),q=b(!0),g=b(0),x=b(null),n=b(new Set),u=b(!1),M=b(!1),z=b(!1),O=async()=>{var e;if(!(w.value||!q.value)){w.value=!0;try{const t=await C.get(`/api/v1/notifications?page=${$.value}&per_page=20`,y.config);if(t.data.status==="success"){const s=t.data.data.notifications||[];i.value.push(...s),g.value=((e=t.data.data.pagination)==null?void 0:e.unread_count)||0,q.value=s.length===20}}catch(t){console.error("Error fetching notifications:",t)}finally{w.value=!1}}},X=async()=>{try{const e=await C.get("/api/v1/notifications/unread-count",y.config);e.data.status==="success"&&(g.value=e.data.data.unread_count||0)}catch(e){console.error("Error fetching unread count:",e)}},R=async e=>{try{await C.post(`/api/v1/notifications/${e}/read`,{},y.config);const t=i.value.find(s=>s.id===e);t&&(t.read=!0,t.read_at=new Date().toISOString(),g.value>0&&g.value--)}catch(t){console.error("Error marking notification as read:",t)}},Z=async()=>{try{await C.post("/api/v1/notifications/read-all",{},y.config),i.value.forEach(e=>{e.read=!0,e.read_at=new Date().toISOString()}),g.value=0}catch(e){console.error("Error marking all as read:",e)}},ee=async e=>{try{await C.delete(`/api/v1/notifications/${e}`,y.config),i.value=i.value.filter(t=>t.id!==e),n.value.delete(e),g.value>0&&g.value--}catch(t){console.error("Error deleting notification:",t)}},V=()=>{u.value=!u.value,u.value||n.value.clear()},F=e=>{n.value.has(e)?n.value.delete(e):n.value.add(e)},te=()=>{n.value.size===i.value.length?n.value.clear():i.value.forEach(e=>n.value.add(e.id))},D=J(()=>n.value.size),G=J(()=>i.value.length>0&&n.value.size===i.value.length),ae=()=>{n.value.size!==0&&(z.value=!0)},se=async()=>{M.value=!0;try{const e=Array.from(n.value);if((await C.post("/api/v1/notifications/bulk-delete",{ids:e},y.config)).data.status==="success"){const s=i.value.filter(k=>n.value.has(k.id)&&!k.read).length;i.value=i.value.filter(k=>!n.value.has(k.id)),g.value=Math.max(0,g.value-s),n.value.clear(),u.value=!1}}catch(e){console.error("Error bulk deleting notifications:",e),alert("Failed to delete notifications. Please try again.")}finally{M.value=!1}},re=e=>{var t;e.read||R(e.id),(t=e.data)!=null&&t.url&&U.push(e.data.url)},H=()=>{x.value&&x.value.disconnect();const e={root:null,rootMargin:"100px",threshold:.1};x.value=new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting&&q.value&&!w.value&&$.value++})},e),setTimeout(()=>{const t=document.querySelector(".notifications-container .last-notification");t&&x.value&&x.value.observe(t)},100)},oe=e=>({post_liked:"â¤ï¸",post_commented:"ðŸ’¬",comment_liked:"ðŸ‘",question_liked:"ðŸ‘",question_upvoted:"â¬†ï¸",question_answered:"ðŸ’¡",answer_upvoted:"â¬†ï¸",answer_replied:"ðŸ’¬",answer_accepted:"âœ…",mentioned:"ðŸ””",followed:"ðŸ‘¤"})[e]||"ðŸ””",le=e=>({post_liked:r.isDark?"bg-red-900/30 text-red-400":"bg-red-100 text-red-600",post_commented:r.isDark?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-600",comment_liked:r.isDark?"bg-yellow-900/30 text-yellow-400":"bg-yellow-100 text-yellow-600",question_liked:r.isDark?"bg-green-900/30 text-green-400":"bg-green-100 text-green-600",question_upvoted:r.isDark?"bg-purple-900/30 text-purple-400":"bg-purple-100 text-purple-600",question_answered:r.isDark?"bg-indigo-900/30 text-indigo-400":"bg-indigo-100 text-indigo-600",answer_upvoted:r.isDark?"bg-purple-900/30 text-purple-400":"bg-purple-100 text-purple-600",answer_replied:r.isDark?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-600",answer_accepted:r.isDark?"bg-green-900/30 text-green-400":"bg-green-100 text-green-600",mentioned:r.isDark?"bg-orange-900/30 text-orange-400":"bg-orange-100 text-orange-600",followed:r.isDark?"bg-pink-900/30 text-pink-400":"bg-pink-100 text-pink-600"})[e]||(r.isDark?"bg-gray-800 text-gray-400":"bg-gray-100 text-gray-600"),ne=e=>{const t=new Date(e),k=new Date-t,S=Math.floor(k/1e3),E=Math.floor(S/60),T=Math.floor(E/60),j=Math.floor(T/24);return j>7?t.toLocaleDateString("en-US",{month:"short",day:"numeric"}):j>0?`${j}d ago`:T>0?`${T}h ago`:E>0?`${E}m ago`:"Just now"};return de(()=>{if(!y.isAuthenticated){U.push("/login");return}O().then(()=>{H()}),X()}),ve(()=>{x.value&&x.value.disconnect()}),fe($,async()=>{$.value>1&&(await O(),H())}),(e,t)=>(l(),p(I,null,[o("div",{class:d(["min-h-screen transition-colors duration-300",a(r).isDark?"bg-gray-950":"bg-gray-50"])},[o("div",_e,[o("div",we,[o("div",null,[o("h1",{class:d(["text-3xl font-bold mb-2",[a(r).isDark?"text-white":"text-gray-900"]])}," Notifications ",2),o("p",{class:d(["text-sm",[a(r).isDark?"text-gray-400":"text-gray-600"]])},[u.value&&D.value>0?(l(),p("span",De,h(D.value)+" notification"+h(D.value!==1?"s":"")+" selected ",1)):(l(),p("span",Ce,h(g.value>0?`${g.value} unread notification${g.value!==1?"s":""}`:"All caught up!"),1))],2)]),o("div",Se,[u.value?(l(),m(a(_),{key:0,variant:"destructive",onClick:ae,disabled:D.value===0||M.value,class:"gap-2"},{default:f(()=>[c(a(Q),{class:"h-4 w-4"}),N(" Delete Selected ("+h(D.value)+") ",1)]),_:1},8,["disabled"])):v("",!0),u.value?(l(),m(a(_),{key:1,variant:"outline",onClick:V,class:"gap-2"},{default:f(()=>[...t[1]||(t[1]=[N(" Cancel ",-1)])]),_:1})):v("",!0),!u.value&&g.value>0?(l(),m(a(_),{key:2,variant:"outline",onClick:Z,class:"gap-2"},{default:f(()=>[c(a(ke),{class:"h-4 w-4"}),t[2]||(t[2]=N(" Mark All Read ",-1))]),_:1})):v("",!0),!u.value&&i.value.length>0?(l(),m(a(_),{key:3,variant:"outline",onClick:V,class:"gap-2"},{default:f(()=>[...t[3]||(t[3]=[N(" Select ",-1)])]),_:1})):v("",!0)])]),u.value&&i.value.length>0?(l(),p("div",{key:0,class:d(["mb-4 p-3 rounded-lg border",[a(r).isDark?"bg-gray-800/50 border-gray-700":"bg-white/50 border-gray-200"]])},[o("div",Ne,[c(a(_),{variant:"ghost",onClick:te,class:"gap-2"},{default:f(()=>[G.value?(l(),m(a(ye),{key:0,class:"h-4 w-4"})):(l(),m(a(xe),{key:1,class:"h-4 w-4"})),N(" "+h(G.value?"Deselect All":"Select All"),1)]),_:1}),o("span",{class:d(["text-sm",[a(r).isDark?"text-gray-400":"text-gray-600"]])},h(D.value)+" of "+h(i.value.length)+" selected ",3)])],2)):v("",!0),o("div",$e,[c(he,{name:"fade",appear:""},{default:f(()=>[(l(!0),p(I,null,P(i.value,(s,k)=>(l(),m(a(Y),{key:s.id,class:d(["transition-all duration-200 border-0 shadow-sm",u.value?"cursor-default":"cursor-pointer",n.value.has(s.id)?a(r).isDark?"bg-blue-900/20 border-2 border-blue-500":"bg-blue-50 border-2 border-blue-500":s.read?a(r).isDark?"bg-gray-800/50 hover:bg-gray-800/70":"bg-white/50 hover:bg-white/80":a(r).isDark?"bg-blue-900/10 hover:bg-blue-900/20 border-l-4 border-blue-500":"bg-blue-50/50 hover:bg-blue-50 border-l-4 border-blue-500",k===i.value.length-1?"last-notification":""]),onClick:S=>u.value?F(s.id):re(s)},{default:f(()=>[c(a(K),{class:"p-4"},{default:f(()=>[o("div",qe,[u.value?(l(),p("div",{key:0,class:"flex-shrink-0 pt-1",onClick:B(S=>F(s.id),["stop"])},[o("div",{class:d(["w-5 h-5 rounded border-2 flex items-center justify-center cursor-pointer transition-colors",[n.value.has(s.id)?(a(r).isDark,"bg-blue-500 border-blue-500"):a(r).isDark?"border-gray-600 hover:border-gray-400":"border-gray-300 hover:border-gray-400"]])},[n.value.has(s.id)?(l(),m(a(W),{key:0,class:"h-3 w-3 text-white"})):v("",!0)],2)],8,Ae)):v("",!0),o("div",{class:d(["flex-shrink-0 w-12 h-12 rounded-lg flex items-center justify-center text-xl",le(s.type)])},h(oe(s.type)),3),o("div",Me,[o("div",ze,[o("div",Ee,[o("h3",{class:d(["text-base font-semibold mb-1",[a(r).isDark?"text-white":"text-gray-900"]])},h(s.title),3),o("p",{class:d(["text-sm mb-2",[a(r).isDark?"text-gray-300":"text-gray-700"]])},h(s.message),3)]),u.value?v("",!0):(l(),p("div",Te,[s.read?v("",!0):(l(),m(a(_),{key:0,variant:"ghost",size:"icon",onClick:B(S=>R(s.id),["stop"]),class:"h-8 w-8"},{default:f(()=>[c(a(W),{class:"h-4 w-4"})]),_:1},8,["onClick"])),c(a(_),{variant:"ghost",size:"icon",onClick:B(S=>ee(s.id),["stop"]),class:"h-8 w-8 text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20"},{default:f(()=>[c(a(Q),{class:"h-4 w-4"})]),_:1},8,["onClick"])]))]),o("div",je,[o("span",{class:d(["text-xs",[(a(r).isDark,"text-gray-500")]])},h(ne(s.created_at)),3),s.notifiable?(l(),p("span",{key:0,class:d(["text-xs font-medium",[a(r).isDark?"text-gray-400":"text-gray-600"]])}," @"+h(s.notifiable.username),3)):v("",!0)])])])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1}),c(pe,{name:"fade"},{default:f(()=>[w.value?(l(),p("div",Ie,[(l(),p(I,null,P(3,s=>c(a(Y),{key:s,class:d(["border-0 shadow-sm",a(r).isDark?"bg-gray-800/50":"bg-white/50"])},{default:f(()=>[c(a(K),{class:"p-4"},{default:f(()=>[o("div",Be,[c(a(A),{class:"w-12 h-12 rounded-lg"}),o("div",Le,[c(a(A),{class:"h-4 w-3/4"}),c(a(A),{class:"h-3 w-full"}),c(a(A),{class:"h-3 w-1/2"})])])]),_:1})]),_:1},8,["class"])),64))])):v("",!0)]),_:1}),!w.value&&i.value.length===0?(l(),m(be,{key:0,icon:"Bell",title:"No notifications yet",subtitle:"You'll see notifications here when someone interacts with your content",size:"default"})):v("",!0),!q.value&&i.value.length>0?(l(),p("div",Ue,[o("p",{class:d(["text-sm",[(a(r).isDark,"text-gray-500")]])},"No more notifications",2)])):v("",!0)])])],2),c(me,{open:z.value,"onUpdate:open":t[0]||(t[0]=s=>z.value=s),title:`Delete ${n.value.size} Notification(s)`,description:`Are you sure you want to delete ${n.value.size} notification(s)? This action cannot be undone.`,"confirm-text":"Delete","cancel-text":"Cancel",variant:"destructive",onConfirm:se},null,8,["open","title","description"])],64))}},st=ie(Oe,[["__scopeId","data-v-5f9fa8fa"]]);export{st as default};
//# sourceMappingURL=Notifications-BxlwHlur.js.map
