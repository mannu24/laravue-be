import{c as pe,p as T,j as le,l as de,I as re,_ as ce,t as be,a as ge,q as fe,J as he,a8 as ye,f as ve,b as s,o as a,d as f,w as b,x as w,D as e,G as p,u as d,A as m,a9 as ie,z as A,T as G,F as B,E as F,at as ue,C as ne,H as D,Q as xe,k as ke,U as we,aA as _e,aB as Ce,aC as $e,aD as Ee,aE as Te,aF as Me,aG as je,aH as Ae}from"./app-Bvnl7d0n.js";import{u as Le,E as Se,_ as Ie}from"./useBookmark-MdNZIhAe.js";import{_ as Ue,a as Pe}from"./DialogContent-QiX1Bk05.js";import{_ as Ne}from"./Card-hOl-Usuy.js";import{_ as De}from"./CardContent-BNEtnmat.js";import{B as Re}from"./bookmark-Afub3nbE.js";import{C as Be}from"./chevron-right-Cq0N1iJW.js";/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=pe("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);function ze(){const n=T([]),H=T(""),U=T(!1),P=le(),M=async c=>{if(c.length)try{const S=await re.get("/api/v1/posts/mention-suggestions?q="+c,P.config);n.value=S.data}catch(S){console.error("Mention search failed:",S)}};return de(H,c=>{c.length>0?M(c):n.value=[]}),{mentionSuggestions:n,mentionQuery:H,isMentioning:U}}const Ve={class:"p-6"},Fe={class:"flex items-center gap-3 mb-4"},He={class:"flex-shrink-0"},qe=["src"],Ge={key:1,src:"/assets/front/images/user.png",alt:"User Avatar",class:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700"},Ke={class:"flex-1 flex items-center justify-between"},We={id:"edit-post-title",class:"font-semibold text-gray-900 dark:text-white text-base"},Qe=["disabled"],Xe={class:"relative"},Je={class:"flex items-center justify-between mt-1"},Ye={key:0,class:"text-xs text-red-600 dark:text-red-400 ml-1"},Ze={key:1,class:"text-xs text-gray-500 dark:text-gray-400 ml-1"},et={key:0,class:"absolute bottom-full left-0 mb-2 w-full max-h-60 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-xl dark:shadow-gray-900/50 overflow-y-auto z-50"},tt=["onMousedown"],rt=["src"],at={key:1,class:"fas fa-user-circle text-2xl text-gray-400 dark:text-gray-500"},st={class:"flex-1 min-w-0"},ot={class:"font-medium text-sm text-gray-900 dark:text-white truncate"},nt={class:"text-xs text-gray-500 dark:text-gray-400 truncate"},lt={key:0,class:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"},dt={class:"text-sm text-red-600 dark:text-red-400"},it={key:1,class:"flex flex-wrap gap-3 pb-2"},ut=["onClick","disabled"],ct=["src"],gt={key:0,class:"absolute bottom-0 left-0 right-0 bg-black/50 text-white text-xs px-2 py-1 rounded-b-xl"},ft={class:"flex items-center justify-between pt-2 border-t border-gray-200 dark:border-gray-700"},vt=["disabled"],mt={key:0},pt={key:1,class:"flex items-center gap-2"},bt={key:1,class:"max-w-2xl mx-auto sm:px-6"},ht={class:"flex items-center gap-3"},yt={class:"flex-shrink-0"},xt=["src"],kt={key:1,src:"/assets/front/images/user.png",alt:"User Avatar",class:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700"},wt={class:"text-gray-500 dark:text-gray-300 text-sm"},_t={key:1,class:"flex-1 flex items-center justify-between"},Ct={class:"font-semibold text-gray-900 dark:text-white text-base"},$t={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Et={class:"relative"},Tt={class:"flex items-center justify-between mt-1"},Mt={key:0,class:"text-xs text-red-600 dark:text-red-400 ml-1"},jt={key:1,class:"text-xs text-gray-500 dark:text-gray-400 ml-1"},At={key:0,class:"absolute bottom-full left-0 mb-2 w-full max-h-60 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-xl dark:shadow-gray-900/50 overflow-y-auto z-50"},Lt=["onMousedown"],St=["src"],It={key:1,class:"fas fa-user-circle text-2xl text-gray-400 dark:text-gray-500"},Ut={class:"flex-1 min-w-0"},Pt={class:"font-medium text-sm text-gray-900 dark:text-white truncate"},Nt={class:"text-xs text-gray-500 dark:text-gray-400 truncate"},Dt={key:0,class:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"},Rt={class:"text-sm text-red-600 dark:text-red-400"},Bt={key:1,class:"flex flex-wrap gap-3 pb-2"},Ot=["onClick","disabled"],zt=["src"],Vt={key:0,class:"absolute bottom-0 left-0 right-0 bg-black/50 text-white text-xs px-2 py-1 rounded-b-xl"},Ft={class:"flex items-center justify-between gap-3 pt-2 border-t border-gray-200 dark:border-gray-700"},Ht=["disabled"],qt={key:0},Gt={key:1,class:"flex items-center gap-2"},R=5e3,Kt={__name:"PostForm",props:["post"],emits:["fetch","close"],setup(n,{emit:H}){const{mentionSuggestions:U,mentionQuery:P}=ze(),M=T({active:!1,position:{node:null,offset:0},query:""}),c=T({title:"",content:"",mentions:[],media:[]}),S=H,x=le();be();const O=T([]),$=T([]),k=T(null),E=n,L=T(!1),_=T(!1),v=T({}),C=ge(()=>k.value?(k.value.innerText||k.value.textContent||"").length:0),N=t=>{L.value=t},K=()=>{c.value.content=k.value.innerHTML,ae()},W=t=>{if(t.key==="Backspace"){const r=window.getSelection();if(!r.rangeCount)return;const i=r.getRangeAt(0),u=z(i);if(u){t.preventDefault(),Q(u);return}}M.value.active&&["Escape","ArrowUp","ArrowDown","Enter"].includes(t.key)&&t.preventDefault()},z=t=>{if(!t.collapsed)return null;let r=t.startContainer,i=t.startOffset;if(r.nodeType===Node.TEXT_NODE)if(i===0)r=r.previousSibling;else return null;else r.nodeType===Node.ELEMENT_NODE&&(i>0?r=r.childNodes[i-1]:r=r.previousSibling);for(;r;){if(r.nodeType===Node.ELEMENT_NODE&&r.classList.contains("mention"))return r;if(r.nodeType===Node.TEXT_NODE&&r.textContent===" ")r=r.previousSibling;else break}return null},Q=t=>{const r=parseInt(t.dataset.userId),i=t.parentNode;i.removeChild(t),console.log(i.innerHTML),c.value.mentions=c.value.mentions.filter(l=>l.id!==r),c.value.content=i.innerHTML;const u=new Event("input",{bubbles:!0});k.value.dispatchEvent(u)},ae=()=>{const t=window.getSelection();if(!t.rangeCount)return;const r=t.getRangeAt(0),i=se(r),u=i.lastIndexOf("@");if(u>-1){const l=i[u-1];if(!l||/\s/.test(l)){M.value={active:!0,position:{node:r.startContainer,offset:u},query:i.slice(u+1)},P.value=M.value.query;return}}M.value.active=!1},se=t=>{let r="",i=t.startContainer;const u=t.startOffset;return i.nodeType===Node.TEXT_NODE&&(r=i.textContent.slice(0,u)),r},X=t=>{if(!M.value.active)return;const r=new Range,i=M.value.position.node,u=M.value.position.offset;r.setStart(i,u),r.setEnd(window.getSelection().getRangeAt(0).endContainer,window.getSelection().getRangeAt(0).endOffset),r.deleteContents();const l=document.createElement("span");l.className="mention-link",l.contentEditable="false",l.dataset.userId=t.id,l.textContent=`@${t.username}`;const g=document.createTextNode(" "),y=document.createDocumentFragment();y.appendChild(l),y.appendChild(g),r.insertNode(y);const j=new Range;j.setStartAfter(g),j.collapse(!0);const I=window.getSelection();I.removeAllRanges(),I.addRange(j),c.value.mentions.some(me=>me.id===t.id)||c.value.mentions.push({id:t.id,username:t.username}),M.value={active:!1,position:{node:null,offset:0},query:""},U.value=[];const q=new Event("input",{bubbles:!0});k.value.dispatchEvent(q),k.value.focus()},J=()=>{c.value={title:"",content:"",mentions:[],media:[]},L.value=!1,v.value={},O.value=[],$.value.forEach(t=>{t.url&&t.url.startsWith("blob:")&&URL.revokeObjectURL(t.url)}),$.value=[],k.value&&(k.value.innerHTML="")},Y=t=>{Array.from(t.target.files).forEach(i=>{if(!c.value.media.some(l=>l.name===i.name&&l.size===i.size)){c.value.media.push(i);const l=URL.createObjectURL(i);$.value.push({type:"og",url:l,id:Date.now()+Math.random()})}}),t.target.value=""},Z=t=>{t.target.src="/placeholder.svg"},oe=()=>{v.value={};let t=!0;return!c.value.title||c.value.title.trim().length===0?(v.value.title="Title is required",t=!1):c.value.title.trim().length>200&&(v.value.title="Title must be less than 200 characters",t=!1),!k.value||!k.value.innerText||k.value.innerText.trim().length===0?(v.value.content="Content is required",t=!1):C.value>R&&(v.value.content=`Content must be less than ${R} characters`,t=!1),t},ee=async()=>{var t,r,i,u,l;if(oe())try{_.value=!0,v.value={};const g=new FormData;g.append("title",c.value.title.trim()),g.append("content",c.value.content),c.value.mentions.forEach((I,q)=>{g.append(`mentions[${q}][id]`,I.id),g.append(`mentions[${q}][username]`,I.username)}),c.value.media.forEach((I,q)=>{g.append(`media[${q}]`,I)}),O.value.forEach(I=>{g.append("deleted[]",I)});const y=E.post?`/api/v1/posts/${E.post.post_code}`:"/api/v1/posts";E.post&&g.append("_method","PUT");const j=await re.post(y,g,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${x.token}`}});j.data.status==="success"?(J(),V(),S("fetch")):v.value.submit=j.data.message||"An error occurred. Please try again."}catch(g){console.error("Error submitting post:",((t=g.response)==null?void 0:t.data)||g.message),(i=(r=g.response)==null?void 0:r.data)!=null&&i.errors?v.value={...v.value,...g.response.data.errors}:v.value.submit=((l=(u=g.response)==null?void 0:u.data)==null?void 0:l.message)||"An error occurred. Please try again."}finally{_.value=!1}},te=(t,r)=>{if(r!=="url"){const i=$.value[t];t<c.value.media.length&&c.value.media.splice(t,1),i.url&&i.url.startsWith("blob:")&&URL.revokeObjectURL(i.url),$.value.splice(t,1)}else{const i=$.value[t].url;O.value.push(i),$.value.splice(t,1)}},V=()=>{_.value||(L.value=!1,J(),S("close"))},h=t=>{t.key==="Escape"&&E.post&&L.value&&V()},o=t=>{t.target===t.currentTarget&&E.post&&V()};return de(()=>E.post&&L.value,t=>{t?(document.body.style.overflow="hidden",document.addEventListener("keydown",h)):(document.body.style.overflow="",document.removeEventListener("keydown",h))},{immediate:!0}),fe(()=>{E.post&&(N(!0),c.value.post_code=E.post.post_code,c.value.content=E.post.content,c.value.title=E.post.title,$.value=E.post.media_urls.map((t,r)=>({type:"url",url:t,id:r})),he(()=>{k.value&&(k.value.innerHTML=E.post.content)}))}),ye(()=>{$.value.forEach(t=>{t.url&&t.url.startsWith("blob:")&&URL.revokeObjectURL(t.url)}),document.body.style.overflow="",document.removeEventListener("keydown",h)}),(t,r)=>E.post?(a(),ve(xe,{key:0,to:"body"},[f(G,{name:"modal",appear:""},{default:b(()=>{var i,u,l,g;return[E.post&&L.value?(a(),s("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:o,role:"dialog","aria-modal":"true","aria-labelledby":"edit-post-title"},[e("div",{class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl dark:shadow-gray-900/50 max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-800",onClick:r[1]||(r[1]=p(()=>{},["stop"]))},[e("div",Ve,[e("div",Fe,[e("div",He,[(i=d(x).user)!=null&&i.profile_photo?(a(),s("img",{key:0,src:(u=d(x).user)==null?void 0:u.profile_photo,alt:"User Avatar",class:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700"},null,8,qe)):(a(),s("img",Ge))]),e("div",Ke,[e("div",null,[e("h3",We,m(((l=d(x).user)==null?void 0:l.name)||((g=d(x).user)==null?void 0:g.username)),1),r[4]||(r[4]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},"Edit Post",-1))]),e("button",{onClick:p(V,["stop"]),disabled:_.value,class:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 disabled:opacity-50 disabled:cursor-not-allowed"},[...r[5]||(r[5]=[e("i",{class:"fas fa-times text-sm"},null,-1)])],8,Qe)])]),e("form",{class:"space-y-4",onSubmit:p(ee,["prevent"])},[f(ie,{type:"text",placeholder:"Title of this post",modelValue:c.value.title,"onUpdate:modelValue":r[0]||(r[0]=y=>c.value.title=y),error:v.value.title,class:"!bg-white dark:!bg-gray-700/50 !border-gray-300 dark:!border-gray-600 !text-gray-900 dark:!text-gray-100 placeholder:!text-gray-400 dark:placeholder:!text-gray-400 focus:!border-green-500 dark:focus:!border-green-500 hover:!border-gray-400 dark:hover:!border-gray-500"},null,8,["modelValue","error"]),e("div",Xe,[e("div",{ref_key:"editor",ref:k,contenteditable:"true",onInput:K,onKeydown:W,"data-placeholder":"Share your thoughts...",class:A(["w-full min-h-[120px] text-sm border rounded-xl px-4 py-3 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500/50 bg-white dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder:text-gray-400 dark:placeholder:text-gray-400 border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 focus:border-green-500 dark:focus:border-green-500",{"border-red-500 dark:border-red-500":v.value.content}])},null,34),e("div",Je,[v.value.content?(a(),s("span",Ye,m(v.value.content),1)):(a(),s("span",Ze)),e("span",{class:A(["text-xs ml-auto",C.value>R?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"])},m(C.value)+" / "+m(R),3)]),f(G,{name:"fade"},{default:b(()=>[d(U).length?(a(),s("div",et,[(a(!0),s(B,null,F(d(U),(y,j)=>(a(),s("div",{key:j,onMousedown:p(I=>X(y),["prevent"]),class:"p-3 hover:bg-gray-100 dark:hover:bg-gray-700/50 cursor-pointer flex items-center gap-3 transition-colors border-b border-gray-100 dark:border-gray-700/50 last:border-0"},[y.avatar?(a(),s("img",{key:0,src:y.avatar,class:"w-10 h-10 rounded-full object-cover ring-1 ring-gray-200 dark:ring-gray-700"},null,8,rt)):(a(),s("i",at)),e("div",st,[e("p",ot,m(y.name),1),e("p",nt,"@"+m(y.username),1)])],40,tt))),128))])):w("",!0)]),_:1})]),v.value.submit?(a(),s("div",lt,[e("p",dt,m(v.value.submit),1)])):w("",!0),$.value.length?(a(),s("div",it,[f(ue,{name:"bounce",appear:""},{default:b(()=>[(a(!0),s(B,null,F($.value,(y,j)=>(a(),s("div",{key:y.id||j,class:"relative h-32 w-32 flex-shrink-0 group"},[e("button",{onClick:I=>te(j,y.type),disabled:_.value,class:"absolute -top-2 -right-2 w-6 h-6 flex items-center justify-center bg-red-500 hover:bg-red-600 dark:bg-red-600 dark:hover:bg-red-700 text-white rounded-full transition-all duration-200 hover:scale-110 z-10 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},[...r[6]||(r[6]=[e("i",{class:"fas fa-times text-xs"},null,-1)])],8,ut),e("img",{src:y.url,class:"h-full w-full rounded-xl object-cover border-2 border-gray-200 dark:border-gray-700 ring-1 ring-gray-100 dark:ring-gray-800",alt:"Image Preview",onError:Z},null,40,ct),y.type==="url"?(a(),s("div",gt," Existing ")):w("",!0)]))),128))]),_:1})])):w("",!0),e("div",ft,[e("input",{type:"file",onChange:Y,accept:"image/*",class:"hidden",id:"media_upload_edit",multiple:"",disabled:_.value},null,40,vt),e("label",{for:"media_upload_edit",class:A(["flex items-center gap-2 px-4 py-2 rounded-lg text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 cursor-pointer transition-colors font-medium text-sm",_.value?"opacity-50 cursor-not-allowed":""])},[...r[7]||(r[7]=[e("i",{class:"fas fa-paperclip"},null,-1),e("span",null,"Attach Media",-1)])],2),f(d(ne),{type:"submit",class:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 dark:from-green-500 dark:to-green-600 dark:hover:from-green-600 dark:hover:to-green-700 text-white transition-all duration-300 shadow-md hover:shadow-lg px-6",disabled:_.value||C.value>R},{default:b(()=>[_.value?(a(),s("span",pt,[...r[8]||(r[8]=[e("i",{class:"fas fa-spinner fa-spin"},null,-1),D(" Updating... ",-1)])])):(a(),s("span",mt,"Update Post"))]),_:1},8,["disabled"])])],32)])])])):w("",!0)]}),_:1})])):(a(),s("div",bt,[f(d(Ne),{class:A(["overflow-hidden transition-all duration-300",[L.value?"shadow-lg border-gray-200 dark:border-gray-800":"shadow-sm hover:shadow-md border-gray-200 dark:border-gray-800 hover:border-gray-300 dark:hover:border-gray-700"]])},{default:b(()=>[e("div",{class:A(["relative overflow-hidden",[L.value?"bg-gradient-to-r from-green-50 via-green-50/25 to-white dark:from-vue/15 dark:via-none dark:to-black":""]])},[f(d(De),{class:"p-0"},{default:b(()=>{var i,u;return[e("div",{class:A(["px-6 py-4",[L.value?"border-b border-gray-200 dark:border-gray-700":""]])},[e("div",ht,[e("div",yt,[(i=d(x).user)!=null&&i.profile_photo?(a(),s("img",{key:0,src:(u=d(x).user)==null?void 0:u.profile_photo,alt:"User Avatar",class:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700"},null,8,xt)):(a(),s("img",kt))]),f(G,{name:"fade",mode:"out-in"},{default:b(()=>{var l,g,y,j;return[L.value?(a(),s("div",_t,[e("div",null,[e("h3",Ct,m(((y=d(x).user)==null?void 0:y.name)||((j=d(x).user)==null?void 0:j.username)),1),e("p",$t,m(t.$filters.date(new Date)),1)])])):(a(),s("div",{key:0,class:"flex-1 rounded-lg h-12 px-4 bg-gray-100 dark:bg-gray-800/50 flex items-center cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-800 transition-colors border border-transparent hover:border-gray-300 dark:hover:border-gray-900",onClick:r[2]||(r[2]=I=>N(!0))},[e("p",wt,"What's on your mind, "+m(((l=d(x).user)==null?void 0:l.name)||((g=d(x).user)==null?void 0:g.username))+"?",1)]))]}),_:1})])],2),L.value?(a(),s("form",{key:0,class:"px-6 py-4 space-y-4",onSubmit:p(ee,["prevent"])},[f(ie,{type:"text",placeholder:"Title of this post",modelValue:c.value.title,"onUpdate:modelValue":r[3]||(r[3]=l=>c.value.title=l),error:v.value.title,class:"!bg-white dark:!bg-gray-700/50 !border-gray-300 dark:!border-gray-600 !text-gray-900 dark:!text-gray-100 placeholder:!text-gray-400 dark:placeholder:!text-gray-400 focus:!border-green-500 dark:focus:!border-green-500 hover:!border-gray-400 dark:hover:!border-gray-500 rounded-md"},null,8,["modelValue","error"]),e("div",Et,[e("div",{ref_key:"editor",ref:k,contenteditable:"true",onInput:K,onKeydown:W,"data-placeholder":"Share your thoughts...",class:A(["w-full min-h-[120px] text-sm border rounded-md px-4 py-3 transition-all duration-200 focus:outline-none bg-white dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder:text-gray-400 dark:placeholder:text-gray-400 border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 focus:border-green-500 dark:focus:border-green-500",{"border-red-500 dark:border-red-500":v.value.content}])},null,34),e("div",Tt,[v.value.content?(a(),s("span",Mt,m(v.value.content),1)):(a(),s("span",jt)),e("span",{class:A(["text-xs ml-auto",C.value>R?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"])},m(C.value)+" / "+m(R),3)]),f(G,{name:"fade"},{default:b(()=>[d(U).length?(a(),s("div",At,[(a(!0),s(B,null,F(d(U),(l,g)=>(a(),s("div",{key:g,onMousedown:p(y=>X(l),["prevent"]),class:"p-3 hover:bg-gray-100 dark:hover:bg-gray-700/50 cursor-pointer flex items-center gap-3 transition-colors border-b border-gray-100 dark:border-gray-700/50 last:border-0"},[l.avatar?(a(),s("img",{key:0,src:l.avatar,class:"w-10 h-10 rounded-full object-cover ring-1 ring-gray-200 dark:ring-gray-700"},null,8,St)):(a(),s("i",It)),e("div",Ut,[e("p",Pt,m(l.name),1),e("p",Nt,"@"+m(l.username),1)])],40,Lt))),128))])):w("",!0)]),_:1})]),v.value.submit?(a(),s("div",Dt,[e("p",Rt,m(v.value.submit),1)])):w("",!0),$.value.length?(a(),s("div",Bt,[f(ue,{name:"bounce",appear:""},{default:b(()=>[(a(!0),s(B,null,F($.value,(l,g)=>(a(),s("div",{key:l.id||g,class:"relative h-32 w-32 flex-shrink-0 group"},[e("button",{onClick:y=>te(g,l.type),disabled:_.value,class:"absolute -top-2 -right-2 w-6 h-6 flex items-center justify-center bg-red-500 hover:bg-red-600 dark:bg-red-600 dark:hover:bg-red-700 text-white rounded-full transition-all duration-200 hover:scale-110 z-10 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},[...r[9]||(r[9]=[e("i",{class:"fas fa-times text-xs"},null,-1)])],8,Ot),e("img",{src:l.url,class:"h-full w-full rounded-xl object-cover border-2 border-gray-200 dark:border-gray-700 ring-1 ring-gray-100 dark:ring-gray-800",alt:"Image Preview",onError:Z},null,40,zt),l.type==="url"?(a(),s("div",Vt," Existing ")):w("",!0)]))),128))]),_:1})])):w("",!0),e("div",Ft,[e("input",{type:"file",onChange:Y,accept:"image/*",class:"hidden",id:"media_upload",multiple:"",disabled:_.value},null,40,Ht),e("label",{for:"media_upload",class:A(["flex items-center gap-2 px-4 py-2 rounded-lg text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 cursor-pointer transition-colors font-medium text-sm",_.value?"opacity-50 cursor-not-allowed":""])},[...r[10]||(r[10]=[e("i",{class:"fas fa-paperclip"},null,-1),e("span",null,"Attach Media",-1)])],2),f(d(ne),{variant:"outline",size:"lg",class:A([_.value?"opacity-50 cursor-not-allowed":"","ms-auto"]),onClick:p(V,["stop"])},{default:b(()=>[...r[11]||(r[11]=[D(" Cancel ",-1)])]),_:1},8,["class"]),f(d(ne),{type:"submit",class:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 dark:from-green-500 dark:to-green-600 dark:hover:from-green-600 dark:hover:to-green-700 text-white transition-all duration-300 shadow-md hover:shadow-lg px-6",disabled:_.value||C.value>R},{default:b(()=>[_.value?(a(),s("span",Gt,[...r[12]||(r[12]=[e("i",{class:"fas fa-spinner fa-spin"},null,-1),D(" Posting... ",-1)])])):(a(),s("span",qt,"Submit Post"))]),_:1},8,["disabled"])])],32)):w("",!0)]}),_:1})],2)]),_:1},8,["class"])]))}},Wt=ce(Kt,[["__scopeId","data-v-90425c5e"]]),Qt={class:"flex flex-col gap-4"},Xt={class:"flex items-start justify-between gap-3"},Jt={class:"flex-1 min-w-0"},Yt={key:0,class:"text-lg cursor-pointer group-hover:text-green-600 dark:group-hover:text-green-400 lg:text-xl font-semibold text-gray-900 dark:text-white leading-tight mb-2 line-clamp-2"},Zt={class:"prose prose-sm dark:prose-invert max-w-none"},er=["innerHTML"],tr={key:0,class:"rounded-lg overflow-hidden border border-gray-100 dark:border-gray-700"},rr={key:0,class:"relative group/media"},ar=["src"],sr={key:1,class:"grid grid-cols-2 gap-1"},or=["src","onClick"],nr={key:2,class:"grid grid-cols-2 gap-1"},lr=["src","onClick"],dr=["src"],ir={key:3,class:"grid grid-cols-2 gap-1 relative"},ur=["src","onClick"],cr={class:"flex flex-wrap items-center justify-between gap-3 text-sm"},gr={class:"flex items-center gap-3 text-gray-500 dark:text-gray-400"},fr={class:"flex items-center gap-2"},vr=["src"],mr={class:"font-medium text-gray-900 dark:text-gray-100"},pr={class:"text-xs text-gray-500 dark:text-gray-400"},br={class:"flex items-center gap-3 text-xs text-gray-500 dark:text-gray-400"},hr={class:"flex flex-wrap items-center justify-between gap-3 pt-3 border-t border-gray-100 dark:border-gray-700"},yr={class:"flex items-center"},xr=["disabled"],kr={class:"relative bg-black/90 rounded-xl overflow-hidden"},wr=["src"],_r={class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/50 backdrop-blur-sm text-white px-4 py-2 rounded-full text-sm"},Cr={__name:"PostCard",props:["post"],emits:["load_more","fetch","delete_post","liked_action","share_url","bookmarked_action"],setup(n,{emit:H}){const U=T(null),P=T(!1),M=T(!1),c=H,S=ke(),x=le(),O=ge(()=>"/feed/"+n.post.post_code),{isBookmarked:$,bookmarkCount:k,isLoading:E,toggleBookmark:L,initialize:_}=Le(n.post,"post");de(()=>n.post,h=>{h&&_(h)},{immediate:!0});const v=T(!1),C=T(0),N=h=>{C.value=h,v.value=!0},K=()=>{C.value<n.post.media_urls.length-1&&C.value++},W=()=>{C.value>0&&C.value--},z=h=>{h.target.src="/placeholder.svg"},Q=h=>{h.target.src="/assets/front/images/user.png"},ae=()=>{M.value=!0,P.value=!1},se=async h=>{P.value=!1,await re.delete(`/api/v1/posts/${n.post.post_code}`,x.config).then(()=>{c("delete_post",n.post.post_code)})},X=h=>h.replace(/@(\w+)/g,'<a href="/@$1">@$1</a>'),J=()=>{new IntersectionObserver(o=>{o.forEach(t=>{t.isIntersecting&&c("load_more")})}).observe(U.value)},Y=async()=>{if(!x.isAuthenticated)S.push("/login");else{const h=await re.get(`/api/v1/posts/like-unlike/${n.post.post_code}`,x.config);h.data.status=="success"?c("liked_action",[n.post.post_code,h.data.liked]):alert("Something went wrong")}},Z=()=>{x.isAuthenticated?S.push(O.value):S.push("/login")},oe=()=>{c("share_url",O.value)},ee=async()=>{if(!x.isAuthenticated){S.push("/login");return}const h=n.post.post_code;if(!h){console.error("Post code not found");return}const o=await L("post",h);o!==void 0&&c("bookmarked_action",[h,o,k.value])},te=()=>{c("fetch")},V=()=>{M.value=!1};return fe(()=>{U.value.classList.contains("last_item")&&J()}),(h,o)=>{var r,i;const t=we("router-link");return a(),s("div",{ref_key:"element",ref:U},[e("article",{onClick:o[12]||(o[12]=u=>d(S).push(O.value)),class:"group bg-white/95 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl p-5 shadow-[0_20px_70px_rgba(15,23,42,0.08)] dark:shadow-none hover:shadow-[0_25px_80px_rgba(15,23,42,0.12)] dark:hover:shadow-xl transition-all duration-300 hover:cursor-pointer hover:border-gray-300 dark:hover:border-gray-700"},[e("div",Qt,[e("div",Xt,[e("div",Jt,[n.post.title?(a(),s("h3",Yt,m(n.post.title),1)):w("",!0),e("div",Zt,[e("p",{class:"text-sm text-gray-600 dark:text-gray-300 line-clamp-3 leading-relaxed whitespace-pre-wrap break-words",innerHTML:X(n.post.content),onClick:o[0]||(o[0]=p(()=>{},["stop"]))},null,8,er)])]),d(x).isAuthenticated&&n.post.owner?(a(),s("div",{key:0,class:"relative flex-shrink-0",onClick:o[6]||(o[6]=p(()=>{},["stop"]))},[e("button",{onClick:o[1]||(o[1]=u=>P.value=!P.value),class:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700/60 text-gray-500 dark:text-gray-400"},[f(d(Se),{class:"w-5 h-5"})]),f(G,{name:"fade"},{default:b(()=>[P.value?(a(),s("div",{key:0,onClick:o[5]||(o[5]=p(()=>{},["stop"])),class:"absolute right-2 top-full mt-2 z-20 w-40 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",role:"menu","aria-orientation":"vertical"},[e("button",{onClick:o[2]||(o[2]=p(u=>ae(),["stop"])),class:"w-full text-left px-4 py-2.5 text-sm flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-700/60 text-gray-700 dark:text-gray-300"},[...o[14]||(o[14]=[e("i",{class:"fas fa-pencil-alt text-xs"},null,-1),D(" Edit Post ",-1)])]),f(d(_e),null,{default:b(()=>[f(d(Ie),{"as-child":""},{default:b(()=>[e("button",{onClick:o[3]||(o[3]=p(()=>{},["stop"])),class:"w-full text-left px-4 py-2.5 text-sm flex items-center gap-2 hover:bg-red-50 dark:hover:bg-red-900/30 text-red-600 dark:text-red-400"},[...o[15]||(o[15]=[e("i",{class:"fas fa-trash text-xs"},null,-1),D(" Delete ",-1)])])]),_:1}),f(d(Ce),null,{default:b(()=>[f(d($e),null,{default:b(()=>[f(d(Ee),null,{default:b(()=>[...o[16]||(o[16]=[D("Are you absolutely sure?",-1)])]),_:1}),f(d(Te),null,{default:b(()=>[...o[17]||(o[17]=[D(" This action cannot be undone. This will permanently delete your post. ",-1)])]),_:1})]),_:1}),f(d(Me),null,{default:b(()=>[f(d(je),null,{default:b(()=>[...o[18]||(o[18]=[D("Cancel",-1)])]),_:1}),f(d(Ae),{onClick:o[4]||(o[4]=p(u=>se("delete"),["stop"]))},{default:b(()=>[...o[19]||(o[19]=[D("Continue",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])):w("",!0)]),_:1})])):w("",!0)]),n.post.media_urls&&n.post.media_urls.length?(a(),s("div",tr,[n.post.media_urls.length===1?(a(),s("div",rr,[e("img",{src:n.post.media_urls[0],alt:"Post Media",class:"w-full h-auto max-h-[500px] object-cover cursor-pointer transition-transform duration-300 group-hover:scale-[1.02]",onClick:o[7]||(o[7]=p(u=>N(0),["stop"])),onError:z},null,40,ar)])):n.post.media_urls.length===2?(a(),s("div",sr,[(a(!0),s(B,null,F(n.post.media_urls,(u,l)=>(a(),s(B,{key:u},[l<2?(a(),s("img",{key:0,src:u,alt:"Post Media",class:"w-full h-64 object-cover cursor-pointer transition-transform duration-300 hover:scale-105",onClick:p(g=>N(l),["stop"]),onError:z},null,40,or)):w("",!0)],64))),128))])):n.post.media_urls.length===3?(a(),s("div",nr,[(a(!0),s(B,null,F(n.post.media_urls.slice(0,2),(u,l)=>(a(),s("img",{key:l,src:u,alt:"Post Media",class:"w-full h-48 object-cover cursor-pointer transition-transform duration-300 hover:scale-105",onClick:p(g=>N(l),["stop"]),onError:z},null,40,lr))),128)),e("img",{src:n.post.media_urls[2],alt:"Post Media",class:"col-span-2 w-full h-64 object-cover cursor-pointer transition-transform duration-300 hover:scale-105",onClick:o[8]||(o[8]=p(u=>N(2),["stop"])),onError:z},null,40,dr)])):(a(),s("div",ir,[(a(!0),s(B,null,F(n.post.media_urls.slice(0,4),(u,l)=>(a(),s("div",{key:l,class:"relative overflow-hidden"},[e("img",{src:u,alt:"Post Media",class:"w-full h-48 object-cover cursor-pointer transition-transform duration-300 hover:scale-110",onClick:p(g=>N(l),["stop"]),onError:z},null,40,ur),l===3&&n.post.media_urls.length>4?(a(),s("div",{key:0,class:"absolute inset-0 bg-black/60 flex items-center justify-center text-white text-lg font-bold cursor-pointer backdrop-blur-sm",onClick:o[9]||(o[9]=p(g=>N(3),["stop"]))}," +"+m(n.post.media_urls.length-4)+" more ",1)):w("",!0)]))),128))]))])):w("",!0),e("div",cr,[e("div",gr,[e("div",fr,[f(t,{to:n.post.user.username!=((r=d(x).user)==null?void 0:r.username)?"/@"+n.post.user.username:"/dashboard",onClick:o[10]||(o[10]=p(()=>{},["stop"])),class:"flex-shrink-0"},{default:b(()=>{var u,l;return[(u=n.post.user)!=null&&u.profile_photo?(a(),s("img",{key:0,src:(l=n.post.user)==null?void 0:l.profile_photo,alt:"User Avatar",class:"w-8 h-8 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700",onError:Q},null,40,vr)):(a(),s("img",{key:1,src:"/assets/front/images/user.png",alt:"User Avatar",class:"w-8 h-8 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700",onError:Q},null,32))]}),_:1},8,["to"]),f(t,{onClick:o[11]||(o[11]=p(()=>{},["stop"])),to:n.post.user.username!=((i=d(x).user)==null?void 0:i.username)?"/@"+n.post.user.username:"/dashboard"},{default:b(()=>[e("div",null,[e("p",mr,m(n.post.user.name),1),e("p",pr,m(n.post.posted_at),1)])]),_:1},8,["to"])])]),e("div",br,[e("span",null,m(n.post.views_count||0)+" views • "+m(n.post.likes_count||0)+" likes",1)])]),e("div",hr,[e("div",yr,[e("button",{class:A(["flex items-center gap-2 px-3 py-1.5 rounded-full text-sm transition-colors",n.post.liked?"bg-red-600/10 text-red-600 dark:bg-red-600/20":"bg-gray-50 text-gray-600 dark:bg-card dark:text-gray-300"]),onClick:p(Y,["stop"])},[e("i",{class:A([n.post.liked?"fas fa-heart":"far fa-heart","text-base"])},null,2),e("span",null,m(n.post.likes_count||0),1)],2),e("button",{class:"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm bg-gray-50 text-gray-600 dark:bg-card dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300",onClick:p(Z,["stop"])},[o[20]||(o[20]=e("i",{class:"far fa-comment text-base"},null,-1)),e("span",null,m(n.post.comments_count||0),1)]),e("button",{class:"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm bg-gray-50 dark:bg-card hover:text-vue transition-all duration-300 text-gray-600 dark:text-gray-300",onClick:p(oe,["stop"])},[...o[21]||(o[21]=[e("i",{class:"far fa-paper-plane text-base"},null,-1),e("span",null,"Share",-1)])])]),e("button",{disabled:d(E)||!d(x).isAuthenticated,class:A(["flex items-center gap-2 px-3 py-1.5 rounded-full text-sm transition-colors",d($)?"bg-yellow-50 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-gray-50 text-gray-600 dark:bg-card dark:text-gray-300"]),onClick:p(ee,["stop"])},[f(d(Re),{class:A(["w-4 h-4",d($)?"fill-current":""])},null,8,["class"]),e("span",null,m(d(k)||n.post.bookmark_count||0),1)],10,xr)])])]),M.value?(a(),ve(Wt,{key:0,onClose:V,onFetch:te,post:n.post},null,8,["post"])):w("",!0),f(d(Pe),{open:v.value,"onUpdate:open":o[13]||(o[13]=u=>v.value=u)},{default:b(()=>[f(d(Ue),{class:"max-w-5xl p-0 border-0 bg-transparent shadow-2xl"},{default:b(()=>[e("div",kr,[e("img",{src:n.post.media_urls[C.value],alt:"Gallery image",class:"w-full h-auto max-h-[80vh] object-contain"},null,8,wr),C.value>0?(a(),s("button",{key:0,onClick:W,class:"absolute left-4 top-1/2 transform -translate-y-1/2 bg-white/10 hover:bg-white/20 backdrop-blur-sm text-white p-3 rounded-full transition-all duration-200 hover:scale-110"},[f(d(Oe),{class:"w-6 h-6"})])):w("",!0),C.value<n.post.media_urls.length-1?(a(),s("button",{key:1,onClick:K,class:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-white/10 hover:bg-white/20 backdrop-blur-sm text-white p-3 rounded-full transition-all duration-200 hover:scale-110"},[f(d(Be),{class:"w-6 h-6"})])):w("",!0),e("div",_r,m(C.value+1)+" / "+m(n.post.media_urls.length),1)])]),_:1})]),_:1},8,["open"])],512)}}},Sr=ce(Cr,[["__scopeId","data-v-3c428cd8"]]);export{Wt as P,Sr as a};
//# sourceMappingURL=PostCard-6SO9_3tv.js.map
