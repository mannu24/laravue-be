import{_ as Z,aj as ee,p as x,k as te,j as J,a as W,l as M,q as se,L as ae,b as m,o as g,D as s,x as _,d as l,w as u,G as c,u as o,A as p,H as q,T as X,z as T,I as G,t as oe,f as F,F as K,E as Y,R as re,m as ne,ar as le}from"./app-DI7wrdgO.js";import{u as ie,E as ue,_ as de,a as ce}from"./PostCard-ClOV3R8I.js";import{_ as ge,a as fe,b as me,c as ve,d as ke,e as he,f as xe,g as ye}from"./AlertDialogTitle-D3Kkndyz.js";import{M as be}from"./message-square-LHM10PKZ.js";import{B as pe}from"./bookmark-DCReLjsF.js";import{_ as we}from"./Skeleton-MrCeb1Nk.js";import{_ as O}from"./EmptyState-BuCmKXH_.js";const qe={class:"flex items-start justify-between p-5 pb-4"},_e={class:"flex items-center gap-3 flex-1 min-w-0"},Ce={class:"relative"},$e=["src"],Se={class:"flex items-center gap-2"},Te={class:"font-semibold text-gray-900 dark:text-white text-base truncate group-hover:text-laravel dark:group-hover:text-laravel transition-colors"},Ae={key:0,class:"text-sm text-gray-500 dark:text-gray-400 truncate"},Be={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Le={key:0,class:"relative inline-block ml-2 self-start"},Ee={role:"none"},Ie={class:"px-5 pb-4"},ze={class:"prose prose-sm dark:prose-invert max-w-none mb-4"},De=["innerHTML"],Ne={class:"px-5 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50"},je={class:"flex items-center justify-between"},Fe={class:"flex items-center gap-6"},Me={class:"text-sm font-medium"},Qe={class:"text-sm font-medium"},Ve={class:"flex items-center gap-4"},He={class:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400"},Pe=["disabled","title"],Re={__name:"QuestionCard",props:["question"],emits:["load_more","fetch","delete_question","liked_action","share_url","bookmarked_action"],setup(e,{emit:L}){const{toast:A}=ee(),b=x(null),y=x(!1),f=L,r=te(),i=J(),w=W(()=>"/qna/"+e.question.slug),{isBookmarked:v,bookmarkCount:E,isLoading:C,toggleBookmark:B,initialize:$}=ie(e.question,"question");M(()=>e.question,a=>{a&&$(a)},{immediate:!0}),se(()=>{var a;(a=b==null?void 0:b.value)!=null&&a.classList.contains("last_item")&&z()});const I=async()=>{y.value=!1,await G.delete(`/api/v1/questions/${e.question.slug}`,i.config).then(()=>{f("delete_question",e.question.slug)})},z=()=>{new IntersectionObserver(t=>{t.forEach(d=>{d.isIntersecting&&f("load_more")})}).observe(b.value)},D=async()=>{var a,t;if(!i.isAuthenticated)r.push("/login");else try{const d=await G.get(`/api/v1/questions/like-unlike/${e.question.slug}`,i.config);d.data.status=="success"?(e.question.liked!==void 0&&(e.question.liked=d.data.liked),d.data.likes_count!==void 0&&(e.question.likes_count=d.data.likes_count),f("liked_action",[e.question.slug,d.data.liked,d.data.likes_count])):A({title:"Error",description:"Something went wrong",variant:"destructive"})}catch(d){A({title:"Error",description:((t=(a=d.response)==null?void 0:a.data)==null?void 0:t.message)||"Something went wrong",variant:"destructive"})}},N=()=>{i.isAuthenticated?r.push(w.value):r.push("/login")},j=()=>{f("share_url",w.value)},n=async()=>{if(!i.isAuthenticated){r.push("/login");return}const a=e.question.slug;if(!a){console.error("Question slug not found");return}const t=await B("question",a);t!==void 0&&f("bookmarked_action",[a,t,E.value])},k=a=>{a.target.src="/assets/front/images/user.png"};return(a,t)=>{var Q,V,H,P,R,U;const d=ae("router-link");return g(),m("div",{ref_key:"element",ref:b},[s("article",{onClick:t[8]||(t[8]=h=>o(r).push(w.value)),class:"group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-sm dark:shadow-gray-900/50 hover:shadow-xl dark:hover:shadow-gray-900 rounded-2xl overflow-hidden hover:cursor-pointer transition-all duration-300 ease-out hover:border-gray-300 dark:hover:border-gray-600 mb-4"},[s("div",qe,[s("div",_e,[l(d,{to:(Q=e.question.user)!=null&&Q.username?e.question.user.username!=((V=o(i).user)==null?void 0:V.username)?"/@"+e.question.user.username:"/dashboard":"#",onClick:t[0]||(t[0]=c(()=>{},["stop"])),class:"flex-shrink-0"},{default:u(()=>{var h,S;return[s("div",Ce,[(h=e.question.user)!=null&&h.profile_photo?(g(),m("img",{key:0,src:(S=e.question.user)==null?void 0:S.profile_photo,alt:"User Avatar",class:"w-14 h-14 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700 transition-all duration-300 group-hover:ring-laravel/50",onError:k},null,40,$e)):(g(),m("img",{key:1,src:"/assets/front/images/user.png",alt:"User Avatar",class:"w-14 h-14 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700 transition-all duration-300 group-hover:ring-laravel/50",onError:k},null,32))])]}),_:1},8,["to"]),l(d,{onClick:t[1]||(t[1]=c(()=>{},["stop"])),to:(H=e.question.user)!=null&&H.username?e.question.user.username!=((P=o(i).user)==null?void 0:P.username)?"/@"+e.question.user.username:"/dashboard":"#",class:"flex-1 min-w-0"},{default:u(()=>{var h,S;return[s("div",Se,[s("h4",Te,p(((h=e.question.user)==null?void 0:h.name)||"Anonymous"),1),(S=e.question.user)!=null&&S.username?(g(),m("span",Ae,"@"+p(e.question.user.username),1)):_("",!0)]),s("p",Be,p(e.question.posted_at||e.question.created_at),1)]}),_:1},8,["to"])]),o(i).isAuthenticated&&e.question.owner?(g(),m("div",Le,[s("button",{onClick:t[2]||(t[2]=c(h=>y.value=!y.value,["stop"])),class:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"},[l(o(ue),{class:"w-5 h-5"})]),l(X,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:u(()=>[y.value?(g(),m("div",{key:0,onClick:t[5]||(t[5]=c(()=>{},["stop"])),class:"absolute right-0 top-full mt-2 z-20 w-40 origin-top-right bg-white dark:bg-gray-800 rounded-xl shadow-lg ring-1 ring-black/5 dark:ring-white/10 overflow-hidden",role:"menu","aria-orientation":"vertical"},[s("div",Ee,[s("button",{onClick:t[3]||(t[3]=c(h=>{a.$router.push("/qna/ask/"+e.question.slug),y.value=!1},["stop"])),class:"w-full text-left px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors flex items-center gap-2"},[...t[9]||(t[9]=[s("i",{class:"fas fa-pencil-alt text-xs"},null,-1),q(" Edit Question ",-1)])]),l(o(ge),null,{default:u(()=>[l(o(de),{"as-child":""},{default:u(()=>[s("button",{onClick:t[4]||(t[4]=c(()=>{},["stop"])),class:"w-full text-left px-4 py-2.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors flex items-center gap-2"},[...t[10]||(t[10]=[s("i",{class:"fas fa-trash text-xs"},null,-1),q(" Delete ",-1)])])]),_:1}),l(o(fe),null,{default:u(()=>[l(o(me),null,{default:u(()=>[l(o(ve),null,{default:u(()=>[...t[11]||(t[11]=[q("Are you absolutely sure?",-1)])]),_:1}),l(o(ke),null,{default:u(()=>[...t[12]||(t[12]=[q(" This action cannot be undone. This will permanently delete your question. ",-1)])]),_:1})]),_:1}),l(o(he),null,{default:u(()=>[l(o(xe),null,{default:u(()=>[...t[13]||(t[13]=[q("Cancel",-1)])]),_:1}),l(o(ye),{onClick:c(I,["stop"])},{default:u(()=>[...t[14]||(t[14]=[q("Continue",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])])):_("",!0)]),_:1})])):_("",!0)]),s("div",Ie,[s("h3",{class:"font-bold text-xl text-gray-900 dark:text-white mb-3 leading-tight line-clamp-2 cursor-pointer hover:text-laravel dark:hover:text-laravel transition-colors",onClick:t[6]||(t[6]=c(h=>o(r).push(w.value),["stop"]))},p(e.question.title),1),s("div",ze,[s("p",{class:"text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-wrap break-words line-clamp-3",innerHTML:((R=e.question.content)==null?void 0:R.substring(0,200))+(((U=e.question.content)==null?void 0:U.length)>200?"...":""),onClick:t[7]||(t[7]=c(()=>{},["stop"]))},null,8,De)])]),s("div",Ne,[s("div",je,[s("div",Fe,[s("button",{onClick:c(D,["stop"]),class:T(["flex items-center gap-2 px-3 py-1.5 rounded-lg transition-all duration-200",e.question.liked?"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20":"text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700/50"])},[s("i",{class:T([e.question.liked?"fas fa-heart":"far fa-heart","text-base"])},null,2),s("span",Me,p(e.question.likes_count||0),1)],2),s("button",{onClick:c(N,["stop"]),class:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-all duration-200"},[l(o(be),{class:"w-4 h-4"}),s("span",Qe,p(e.question.comments_count||e.question.answers_count||0),1)]),s("button",{onClick:c(j,["stop"]),class:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-gray-600 dark:text-gray-400 hover:text-green-600 dark:hover:text-green-400 hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-all duration-200"},[...t[15]||(t[15]=[s("i",{class:"far fa-paper-plane text-base"},null,-1),s("span",{class:"text-sm font-medium"},"Share",-1)])])]),s("div",Ve,[s("div",He,[t[16]||(t[16]=s("i",{class:"far fa-eye"},null,-1)),s("span",null,p(e.question.views_count||e.question.views||0)+" views",1)]),s("button",{onClick:c(n,["stop"]),disabled:o(C)||!o(i).isAuthenticated,class:T(["p-2 rounded-lg transition-all duration-200",o(v)?"text-yellow-600 dark:text-yellow-400 hover:bg-yellow-50 dark:hover:bg-yellow-900/20":"text-gray-600 dark:text-gray-400 hover:text-yellow-600 dark:hover:text-yellow-400 hover:bg-gray-100 dark:hover:bg-gray-700/50",o(C)?"opacity-50 cursor-not-allowed":"cursor-pointer"]),title:o(v)?"Remove from bookmarks":"Save to bookmarks"},[l(o(pe),{class:T(["w-5 h-5 transition-transform duration-200",o(v)?"fill-current":"",o(C)?"animate-pulse":""])},null,8,["class"])],10,Pe)])])])])],512)}}},Ue=Z(Re,[["__scopeId","data-v-71145d90"]]),Ge={class:"max-w-2xl mx-auto flex flex-col gap-4 sm:px-6 pb-5 infinite-scroll-container"},Ke={key:0,class:"gap-6 grid w-full"},tt={__name:"InfiniteScroll",props:["fetchKey","username","scrolling"],emits:["share_url"],setup(e,{emit:L}){const A=J();oe();const b=x(null),y=x(null),f=x(1),r=x([]),i=x(!1),w=x(1),v=x(!1),E=L,C=W(()=>{if(e.scrolling=="post")return"/api/v1/feed?page="+f.value;if(e.scrolling=="qna")return"/api/v1/questions-feed?page="+f.value}),B=()=>{f.value=1,r.value=[],v.value=!1},$=async()=>{i.value||(i.value=!0,await axios.post(C.value,{username:e.username},A.config).then(n=>{r.value.push(...n.data.records.data),y.value=n.data.records.data.length,i.value=!1,v.value=!0,b.value={page:n.data.records.current_page,pageSize:n.data.records.per_page,pageCount:n.data.records.last_page,total:n.data.records.total}}).catch(()=>{i.value=!1,v.value=!0}))},I=n=>{r.value=r.value.filter(k=>k.post_code!==n)},z=n=>{r.value=r.value.filter(k=>k.slug!==n)},D=()=>{y.value>0&&(f.value++,$())},N=n=>{E("share_url",n)},j=async n=>{r.value.find((k,a)=>{k.post_code===n[0]&&(r.value[a].liked=n[1],n[1]?r.value[a].likes_count++:r.value[a].likes_count--)})};return $(),M(f,async n=>{$()}),M(()=>e.fetchKey,async n=>{B()}),(n,k)=>(g(),m("div",Ge,[l(le,{name:"fade",appear:""},{default:u(()=>[(g(!0),m(K,null,Y(r.value,(a,t)=>(g(),F(re(e.scrolling==="post"?ce:Ue),ne({key:t,onShare_url:N,onFetch:B,onLiked_action:j,onDelete_post:I,onDelete_question:z,onLoad_more:D,class:t===r.value.length-w.value?"last_item":""},{ref_for:!0},{[e.scrolling==="post"?"post":"question"]:a}),null,16,["class"]))),128))]),_:1}),l(X,{class:"w-full",name:"fade"},{default:u(()=>[i.value?(g(),m("div",Ke,[(g(),m(K,null,Y(5,a=>l(o(we),{key:a,class:T(["w-full rounded-2xl",e.scrolling=="post"?"h-[400px]":"h-[250px]"])},null,8,["class"])),64))])):_("",!0)]),_:1}),!i.value&&v.value&&r.value.length===0&&e.scrolling==="post"?(g(),F(O,{key:0,icon:"FileText",title:"No Posts Yet",subtitle:"This user hasn't posted anything yet.",size:"small"})):_("",!0),!i.value&&v.value&&r.value.length===0&&e.scrolling==="qna"?(g(),F(O,{key:1,icon:"FileText",title:"No Questions Yet",subtitle:"This user hasn't asked any questions yet.",size:"small"})):_("",!0)]))}};export{Ue as Q,tt as _};
//# sourceMappingURL=InfiniteScroll-DdKMyJmZ.js.map
