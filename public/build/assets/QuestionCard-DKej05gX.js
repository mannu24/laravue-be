import{c as X,_ as Z,a3 as ee,k as te,j as ae,al as se,p as $,a as v,l as re,q as oe,b as c,o as p,D as s,x,F as le,E as ne,d as i,H as g,u as r,A as f,G as y,w as d,aA as ie,aB as ue,aC as de,aD as ce,aE as pe,aF as fe,aG as ge,aH as me,T as ve,z as q,I as L}from"./app-Bvnl7d0n.js";import{u as xe,E as ye,_ as ke}from"./useBookmark-MdNZIhAe.js";import{T as he}from"./tag-6Idb4Hv2.js";import{C as _e}from"./circle-check-BE19kObe.js";import{M as be}from"./message-square-I2NocKB-.js";import{B as we}from"./bookmark-Afub3nbE.js";/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=X("CircleChevronUpIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m8 14 4-4 4 4",key:"fy2ptz"}]]),$e={class:"flex flex-col gap-4"},qe={key:0,class:"flex flex-wrap items-center gap-2 text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400"},Be={key:0,class:"flex items-center gap-1 px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300"},De={class:"flex items-start justify-between gap-3"},Ae={class:"flex-1 min-w-0"},Me={class:"text-lg cursor-pointer group-hover:text-laravel lg:text-xl font-semibold text-gray-900 dark:text-white leading-tight mb-2 line-clamp-2"},Te=["innerHTML"],Ee={key:0,class:"absolute right-0 top-full mt-2 z-20 w-40 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden"},Ie={class:"flex flex-wrap items-center justify-between gap-3 text-sm"},Le={class:"flex items-center gap-3 text-gray-500 dark:text-gray-400"},Se={class:"flex items-center gap-2"},je=["src","alt"],Ue={class:"font-medium text-gray-900 dark:text-gray-100"},Ve={class:"text-xs text-gray-500 dark:text-gray-400"},ze={class:"flex items-center gap-3 text-xs text-gray-500 dark:text-gray-400"},Ne={class:"flex flex-wrap items-center justify-between gap-3 pt-3 border-t border-gray-100 dark:border-gray-700"},Fe={class:"flex items-center"},He=["disabled"],Oe={__name:"QuestionCard",props:{question:{type:Object,required:!0},navigateOnClick:{type:Boolean,default:!0},showDescription:{type:Boolean,default:!0}},emits:["load_more","fetch","delete_question","liked_action","share_url","bookmarked_action","open"],setup(B,{emit:S}){const D=B,k=S,a=ee(D,"question"),h=te(),m=ae(),{toast:j}=se(),b=$(null),_=$(!1),w=$(!1),C=v(()=>{var e,t;return`/qna/${((e=a.value)==null?void 0:e.slug)||((t=a.value)==null?void 0:t.id)}`}),A=v(()=>{var t,l,n;const e=((t=a.value)==null?void 0:t.tags)||((l=a.value)==null?void 0:l.topics)||((n=a.value)==null?void 0:n.labels);return e?Array.isArray(e)?e:typeof e=="string"?e.split(",").map(u=>u.trim()).filter(Boolean):[]:[]}),M=v(()=>{var e;return((e=a.value)==null?void 0:e.is_verified)||!1}),U=v(()=>{var e,t,l;return((e=a.value)==null?void 0:e.body)||((t=a.value)==null?void 0:t.content)||((l=a.value)==null?void 0:l.ai_generated_summary)||"No description"}),V=v(()=>{var e,t;return K(((e=a.value)==null?void 0:e.created_at)||((t=a.value)==null?void 0:t.posted_at))}),{isBookmarked:T,bookmarkCount:E,isLoading:z,toggleBookmark:N,initialize:F}=xe(a.value,"question");re(a,e=>{e&&F(e)},{immediate:!0});const H=()=>{var e,t;k("open",((e=a.value)==null?void 0:e.id)||((t=a.value)==null?void 0:t.slug)),D.navigateOnClick&&h.push(C.value)},O=e=>{e==null||e.stopPropagation(),m.isAuthenticated?h.push(C.value):h.push("/login")},P=e=>{e==null||e.stopPropagation(),k("share_url",C.value)},Q=async e=>{var n,u;if(e==null||e.stopPropagation(),!m.isAuthenticated){h.push("/login");return}const t=((n=a.value)==null?void 0:n.slug)||((u=a.value)==null?void 0:u.id);if(!t)return;const l=await N("question",t);k("bookmarked_action",[t,l,E.value])},R=async e=>{var t,l;if(e==null||e.stopPropagation(),!m.isAuthenticated){h.push("/login");return}try{const n=await L.post(`/api/v1/questions/${a.value.id}/toggle-upvote`,{},m.config);a.value.upvoted=n.data.data.upvoted,a.value.upvotes_count=n.data.data.upvotes_count}catch(n){j({title:"Error",description:((l=(t=n.response)==null?void 0:t.data)==null?void 0:l.message)||"Something went wrong",variant:"destructive"})}},G=async()=>{if(!w.value){w.value=!0;try{_.value=!1,await L.delete(`/api/v1/questions/${a.value.slug}`,m.config),k("delete_question",a.value.slug)}finally{w.value=!1}}},J=e=>{e.target.src="/assets/front/images/user.png"},Y=()=>{const e=new IntersectionObserver(t=>{t.forEach(l=>{l.isIntersecting&&k("load_more")})});b.value&&e.observe(b.value)};oe(()=>{var e;(e=b.value)!=null&&e.classList.contains("last_item")&&Y()});const K=e=>{if(!e)return"";const t=new Date(e),n=new Date-t,u=Math.floor(n/(1e3*60*60)),o=Math.floor(n/(1e3*60*60*24));return u<1?"Just now":u<24?`${u}h ago`:o===1?"Yesterday":o<7?`${o} days ago`:o<30?`${Math.floor(o/7)} weeks ago`:o<365?`${Math.floor(o/30)} months ago`:`${Math.floor(o/365)} years ago`},I=v(()=>{var e;return((e=a.value)==null?void 0:e.upvotes_count)??0}),W=v(()=>{var e;return((e=a.value)==null?void 0:e.upvoted)!==void 0?a.value.upvoted:!1});return(e,t)=>{var l,n,u;return p(),c("div",{ref_key:"element",ref:b,class:"question-card-wrapper"},[s("article",{class:"group bg-card border border-gray-200 dark:border-gray-700 rounded-lg p-5 hover:shadow-xl transition-all duration-300 hover:-translate-y-0.5",onClick:H,"data-test":"question-card"},[s("div",$e,[A.value.length||M.value?(p(),c("div",qe,[(p(!0),c(le,null,ne(A.value,o=>(p(),c("span",{key:`tag-${typeof o=="string"?o:o.id||o.name}`,class:"flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-700/60 text-gray-600 dark:text-gray-300"},[i(r(he),{class:"h-3.5 w-3.5"}),g(" "+f(typeof o=="string"?o:o.name),1)]))),128)),M.value?(p(),c("span",Be,[i(r(_e),{class:"h-3.5 w-3.5"}),t[3]||(t[3]=g(" Solved ",-1))])):x("",!0)])):x("",!0),s("div",De,[s("div",Ae,[s("h3",Me,f(a.value.title),1),B.showDescription?(p(),c("p",{key:0,class:"text-sm text-gray-600 dark:text-gray-300 line-clamp-3",innerHTML:U.value},null,8,Te)):x("",!0)]),r(m).isAuthenticated&&a.value.owner?(p(),c("div",{key:0,class:"relative flex-shrink-0",onClick:t[2]||(t[2]=y(()=>{},["stop"]))},[s("button",{onClick:t[0]||(t[0]=o=>_.value=!_.value),class:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700/60 text-gray-500 dark:text-gray-400"},[i(r(ye),{class:"w-5 h-5"})]),i(ve,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:d(()=>[_.value?(p(),c("div",Ee,[s("button",{class:"w-full text-left px-4 py-2.5 text-sm flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-700/60 text-gray-700 dark:text-gray-300",onClick:t[1]||(t[1]=y(o=>{e.$router.push("/qna/ask/"+a.value.slug),_.value=!1},["stop"]))},[...t[4]||(t[4]=[s("i",{class:"fas fa-pencil-alt text-xs"},null,-1),g(" Edit Question ",-1)])]),i(r(ie),null,{default:d(()=>[i(r(ke),{"as-child":""},{default:d(()=>[...t[5]||(t[5]=[s("button",{class:"w-full text-left px-4 py-2.5 text-sm flex items-center gap-2 hover:bg-red-50 dark:hover:bg-red-900/30 text-red-600 dark:text-red-400"},[s("i",{class:"fas fa-trash text-xs"}),g(" Delete ")],-1)])]),_:1}),i(r(ue),null,{default:d(()=>[i(r(de),null,{default:d(()=>[i(r(ce),null,{default:d(()=>[...t[6]||(t[6]=[g("Delete question?",-1)])]),_:1}),i(r(pe),null,{default:d(()=>[...t[7]||(t[7]=[g(" This action cannot be undone. This will permanently delete your question. ",-1)])]),_:1})]),_:1}),i(r(fe),null,{default:d(()=>[i(r(ge),null,{default:d(()=>[...t[8]||(t[8]=[g("Cancel",-1)])]),_:1}),i(r(me),{onClick:G},{default:d(()=>[...t[9]||(t[9]=[g(" Delete ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])):x("",!0)]),_:1})])):x("",!0)]),s("div",Ie,[s("div",Le,[s("div",Se,[(l=a.value.user)!=null&&l.profile_photo?(p(),c("img",{key:0,src:a.value.user.profile_photo,alt:(n=a.value.user)==null?void 0:n.name,class:"w-8 h-8 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700",onError:J},null,40,je)):x("",!0),s("div",null,[s("p",Ue,f(((u=a.value.user)==null?void 0:u.name)||"Anonymous"),1),s("p",Ve,f(V.value),1)])])]),s("div",ze,[s("span",null,f(a.value.views_count||a.value.views||0)+" views â€¢ "+f(I.value)+" upvotes",1)])]),s("div",Ne,[s("div",Fe,[s("button",{class:q(["flex items-center gap-2 px-3 py-1.5 rounded-full text-sm transition-colors",W.value?"bg-red-600/10 text-red-600 dark:bg-red-600/20":"bg-card text-gray-600 dark:text-gray-300"]),onClick:y(R,["stop"])},[i(r(Ce),{class:"w-4 h-4"}),s("span",null,f(I.value),1)],2),s("button",{class:"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm bg-card text-gray-600 dark:text-gray-300",onClick:y(O,["stop"])},[i(r(be),{class:"w-4 h-4"}),s("span",null,f(a.value.comments_count||a.value.answers_count||0),1)]),s("button",{class:"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm bg-card text-vue",onClick:y(P,["stop"])},[...t[10]||(t[10]=[s("i",{class:"far fa-paper-plane text-base"},null,-1),s("span",null,"Share",-1)])])]),s("button",{disabled:r(z)||!r(m).isAuthenticated,class:q(["flex items-center gap-2 px-3 py-1.5 rounded-full text-sm transition-colors",r(T)?"bg-yellow-50 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-card text-gray-600 dark:text-gray-300"]),onClick:y(Q,["stop"])},[i(r(we),{class:q(["w-4 h-4",r(T)?"fill-current":""])},null,8,["class"]),s("span",null,f(r(E)||a.value.bookmark_count||0),1)],10,He)])])])],512)}}},Ke=Z(Oe,[["__scopeId","data-v-252d5723"]]);export{Ce as C,Ke as Q};
//# sourceMappingURL=QuestionCard-DKej05gX.js.map
