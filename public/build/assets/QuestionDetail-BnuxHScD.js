import{c as J,f as A,o as d,w as l,r as X,z as ee,u as t,e as te,ah as se,n as ae,h as ne,ai as re,m as oe,aj as le,ak as ie,p as b,b as x,F as N,E as Q,D as n,x as L,d as s,H as y,A as _,C,al as ue,j as de,a as D,R as ce,q as pe,I as H,l as me,k as ve}from"./app-Bvnl7d0n.js";import{_ as P}from"./Card-hOl-Usuy.js";import{_ as I}from"./CardContent-BNEtnmat.js";import{_ as Z,a as fe}from"./MarkDownEditor-DpqBeoeV.js";import{_ as E,a as Y}from"./CardTitle-ITTEzIVV.js";import{_ as he}from"./BackNavigator-W4HPAldQ.js";import{C as xe,Q as _e}from"./QuestionCard-DKej05gX.js";import{M as ye}from"./message-square-I2NocKB-.js";import{C as ge}from"./chevron-up-ClYMuBWv.js";import{L as we}from"./LoadingSpinner-ekVe37eh.js";import{_ as be}from"./EmptyState-DVLWfdwK.js";import"./useBookmark-MdNZIhAe.js";import"./tag-6Idb4Hv2.js";import"./circle-check-BE19kObe.js";import"./bookmark-Afub3nbE.js";import"./folder-open-BnUa1mLa.js";import"./activity-BXHlTU9J.js";import"./code-xml-5bxqMtxa.js";import"./file-text-CMcMhd5a.js";import"./search-5LIDw_UH.js";/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=J("LockIcon",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=J("PenLineIcon",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),W={__name:"Avatar",props:{class:{type:null,required:!1},size:{type:null,required:!1,default:"sm"},shape:{type:null,required:!1,default:"circle"}},setup(p){const v=p;return(g,m)=>(d(),A(t(se),{class:ee(t(te)(t(Ce)({size:p.size,shape:p.shape}),v.class))},{default:l(()=>[X(g.$slots,"default")]),_:3},8,["class"]))}},K={__name:"AvatarFallback",props:{delayMs:{type:Number,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(p){const v=p;return(g,m)=>(d(),A(t(re),ae(ne(v)),{default:l(()=>[X(g.$slots,"default")]),_:3},16))}},G={__name:"AvatarImage",props:{src:{type:String,required:!0},referrerPolicy:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(p){const v=p;return(g,m)=>(d(),A(t(le),oe(v,{class:"h-full w-full object-cover"}),null,16))}},Ce=ie("inline-flex items-center justify-center font-normal text-foreground select-none shrink-0 bg-secondary overflow-hidden",{variants:{size:{sm:"h-10 w-10 text-xs",base:"h-16 w-16 text-2xl",lg:"h-32 w-32 text-5xl"},shape:{circle:"rounded-full",square:"rounded-md"}}}),qe={class:"space-y-4"},Ae={class:"bg-card border border-gray-200 dark:border-gray-800 rounded-lg shadow"},Le={class:"flex flex-col md:flex-row md:items-start md:justify-between gap-4 px-4 md:px-5 py-4"},Re={class:"flex-1 min-w-0"},ze=["innerHTML"],Me={class:"flex items-center gap-2 md:gap-4 text-sm text-gray-500 flex-wrap"},Se={class:"flex items-center gap-2"},Ue={class:"text-xs md:text-sm"},Te={class:"flex flex-row md:flex-col items-center md:items-end justify-between md:justify-start gap-2 md:gap-2 w-full md:w-auto"},Ve={class:"text-xs md:text-sm"},je={key:0,class:"px-4 md:px-5 pb-4 border-t border-gray-200 dark:border-gray-800 md:border-l-2 md:border-t-0 md:border-l-primary md:ml-4 md:pl-4 md:pr-5"},Fe={class:"flex flex-row justify-end gap-2 mt-2"},Be={key:0,class:"mt-2"},De={class:"flex flex-col md:flex-row gap-3 md:gap-4 p-3 md:p-4 bg-card border border-gray-200 dark:border-gray-800 rounded-lg shadow"},He={class:"flex-1 min-w-0"},Pe=["innerHTML"],Ie={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 mt-3 md:mt-4"},Ne={class:"flex items-center gap-2 md:gap-4 text-xs md:text-sm text-gray-500 flex-wrap"},Qe={class:"flex items-center gap-2"},Ee={class:"text-xs"},Ye={key:0,class:"flex items-center gap-1"},We=["onClick"],Ke={class:"text-xs md:text-sm font-medium"},Ge={key:0,class:"ml-2 md:ml-6 pl-2 md:pl-4 mt-2"},Je={__name:"AnswersWithReplies",props:{items:{type:Array,required:!0},authUserId:{type:Number,required:!0},maxReplies:{type:Number,default:0}},emits:["reply","upvote"],setup(p,{emit:v}){const g=p,m=v,q=b({}),f=b({});b({});const S=b({}),k=r=>{q.value[r]=!q.value[r],q.value[r]||(f.value[r]="")},U=r=>{const c=f.value[r];c!=null&&c.trim()&&(m("reply",{parentId:r,content:c}),k(r))},h=r=>{S.value[r]=!S.value[r]},R=r=>{const c=g.items.find(o=>o.id===r);return!c||!c.replies?[]:S.value[r]?c.replies:c.replies.slice(0,g.maxReplies)},z=r=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(new Date(r)),T=r=>r?r.split(" ").map(c=>c[0]).join("").toUpperCase():"?";return(r,c)=>(d(),x("div",qe,[(d(!0),x(N,null,Q(p.items,o=>{var F;return d(),x("div",{key:o.id,class:"relative"},[n("div",Ae,[n("div",Le,[n("div",Re,[n("div",{innerHTML:o.body,class:"prose dark:prose-invert max-w-none text-sm mb-3 md:mb-4"},null,8,ze),n("div",Me,[n("div",Se,[s(t(W),{class:"h-6 w-6 bg-red-700"},{default:l(()=>{var i;return[(i=o.user)!=null&&i.avatar_url?(d(),A(t(G),{key:0,src:o.user.avatar_url},null,8,["src"])):L("",!0),s(t(K),{class:"text-white"},{default:l(()=>{var M;return[y(_(T((M=o.user)==null?void 0:M.name)),1)]}),_:2},1024)]}),_:2},1024),n("div",Ue,_(((F=o.user)==null?void 0:F.name)||"Anonymous")+" â€¢ "+_(z(o.created_at)),1)])])]),n("div",Te,[s(t(C),{onClick:i=>r.$emit("upvote",o.id),variant:"outline",size:"sm",class:"flex items-center space-x-1"},{default:l(()=>[s(t(xe),{class:"h-5 w-5 md:h-6 md:w-6"}),n("span",Ve,_(o.upvotes_count||o.upvotes||0),1)]),_:2},1032,["onClick"]),s(t(C),{variant:"ghost",size:"sm",onClick:i=>k(o.id),class:"flex-shrink-0"},{default:l(()=>[s(t(ye),{class:"h-4 w-4 mr-1"}),c[0]||(c[0]=n("span",{class:"hidden sm:inline"},"Reply",-1))]),_:1},8,["onClick"])])]),q.value[o.id]?(d(),x("div",je,[s(Z,{modelValue:f.value[o.id],"onUpdate:modelValue":i=>f.value[o.id]=i,placeholder:"Write your reply...","min-height":100},null,8,["modelValue","onUpdate:modelValue"]),n("div",Fe,[s(t(C),{variant:"outline",size:"sm",onClick:i=>k(o.id),class:"w-full sm:w-auto"},{default:l(()=>[...c[1]||(c[1]=[y("Cancel",-1)])]),_:1},8,["onClick"]),s(t(C),{size:"sm",onClick:i=>U(o.id),class:"w-full sm:w-auto"},{default:l(()=>[...c[2]||(c[2]=[y("Post Reply",-1)])]),_:1},8,["onClick"])])])):L("",!0)]),o.replies&&o.replies.length>0?(d(),x("div",Be,[(d(!0),x(N,null,Q(R(o.id),i=>{var M,B;return d(),x("div",{key:i.id,class:"ml-2 md:ml-6 border-l-2 border-gray-200 dark:border-gray-700 pl-2 md:pl-4 py-2"},[n("div",De,[n("div",He,[n("div",{innerHTML:i.content,class:"prose dark:prose-invert max-w-none text-sm"},null,8,Pe),n("div",Ie,[n("div",Ne,[n("div",Qe,[s(t(W),{class:"h-5 w-5 md:h-6 md:w-6"},{default:l(()=>{var V;return[(V=i.user)!=null&&V.avatar_url?(d(),A(t(G),{key:0,src:i.user.avatar_url},null,8,["src"])):L("",!0),s(t(K),{class:"text-white text-xs"},{default:l(()=>{var a;return[y(_(T((a=i.user)==null?void 0:a.name)),1)]}),_:2},1024)]}),_:2},1024),n("span",null,_(((M=i.user)==null?void 0:M.name)||"Anonymous"),1)]),n("span",Ee,_(z(i.created_at)),1)]),((B=i.user)==null?void 0:B.id)!==p.authUserId?(d(),x("div",Ye,[n("button",{onClick:V=>r.$emit("upvote",{id:i.id,type:"answer"}),class:"p-1.5 md:p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[s(t(ge),{class:"h-3.5 w-3.5 md:h-4 md:w-4"})],8,We),n("span",Ke,_(i.upvotes_count||0),1)])):L("",!0)])])])])}),128)),o.replies.length>p.maxReplies?(d(),x("div",Ge,[s(t(C),{variant:"ghost",size:"sm",onClick:i=>h(o.id),class:"text-xs md:text-sm text-gray-500 hover:text-gray-700 dark:hover:text-gray-400"},{default:l(()=>[y(_(S.value[o.id]?"Show Less":`Show More (${o.replies.length-p.maxReplies} more)`),1)]),_:2},1032,["onClick"])])):L("",!0)])):L("",!0)])}),128))]))}},Xe={class:"max-w-4xl mx-auto py-5"},Ze={key:0,class:"min-h-[60vh] flex flex-col items-center justify-center text-center gap-3"},Oe={key:1,class:"space-y-6"},et=["innerHTML"],tt={class:"flex justify-between mt-4"},st={class:"text-lg font-medium"},at={class:"space-x-4"},nt={class:"space-y-4"},Ct={__name:"QuestionDetail",setup(p){const v=ce(),g=ve(),{toast:m}=ue(),q=de(),f=D(()=>q.token),S=D(()=>{var a;return(a=q.user)==null?void 0:a.id}),k=b(!1),U=b(null),h=b(null),R=b([]),z=b(""),T=b(!0),r=b(!1),c=[{name:"Questions",href:"/qna"},{name:v.params.slug,href:"/qna/"+v.params.slug}],o=D(()=>{if(!h.value)return"";const a=h.value.content||h.value.body||"";if(!a)return"";const e=300;return a.length<=e||r.value?a:a.slice(0,e)+"..."}),F=D(()=>h.value?(h.value.content||h.value.body||"").length>300:!1);pe(async()=>{var a,e;U.value=v.params.slug;try{await i()}catch(u){m({title:"Error",description:((e=(a=u==null?void 0:u.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to fetch question details.",variant:"destructive"})}finally{T.value=!1}});const i=async()=>{const a=await H.get(`/api/v1/questions/${U.value}`,q.isAuthenticated?q.config:{});h.value=a.data.data.question,R.value=a.data.data.answers||[]};me(()=>v.params.slug,a=>{U.value=a,i()});const M=async()=>{var a,e;try{const u=await H.post(`/api/v1/questions/${h.value.id}/answers`,{content:z.value},{headers:{Authorization:`Bearer ${f.value}`}});R.value.push(u.data.data),z.value="",k.value=!1,m({title:"Answer submitted",description:"Your answer has been posted."})}catch(u){m({title:"Error",description:((e=(a=u==null?void 0:u.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to submit answer.",variant:"destructive"})}},B=async({parentId:a,content:e})=>{var u,j;if(!f.value)return m({title:"Authentication required",description:"Log in to reply.",variant:"warning"});try{const w=await H.post(`/api/v1/answers/${a}/replies`,{content:e},{headers:{Authorization:`Bearer ${f.value}`}});m({title:"Reply submitted",description:"Your reply has been posted."}),await i()}catch(w){m({title:"Error",description:((j=(u=w==null?void 0:w.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to submit reply.",variant:"destructive"})}},V=async a=>{var u,j;if(!f.value)return m({title:"Authentication required",description:"Log in to upvote.",variant:"warning"});const e=typeof a=="object"?a.id:a;try{await H.post(`/api/v1/answers/${e}/upvote`,{},{headers:{Authorization:`Bearer ${f.value}`}});const w=O=>{for(const $ of O){if($.id===e)return $.upvotes_count!==void 0?$.upvotes_count=($.upvotes_count||0)+1:$.upvotes!==void 0&&($.upvotes=($.upvotes||0)+1),!0;if($.replies&&$.replies.length>0&&w($.replies))return!0}return!1};w(R.value),m({title:"Upvoted",description:"You upvoted this answer."})}catch(w){m({title:"Error",description:((j=(u=w==null?void 0:w.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to upvote answer.",variant:"destructive"})}};return(a,e)=>(d(),x("div",Xe,[T.value?(d(),x("div",Ze,[s(we,{size:"lg"}),e[5]||(e[5]=n("p",{class:"text-gray-600 dark:text-gray-300"},"Loading question...",-1))])):h.value?(d(),x("div",Oe,[s(he,{items:c}),s(_e,{class:"mb-5",question:h.value,"navigate-on-click":!1,"show-description":!1,onOpen:()=>{}},null,8,["question"]),s(t(P),{class:"border border-gray-200 dark:border-gray-800 bg-white dark:bg-black/60 shadow-sm"},{default:l(()=>[s(t(E),{class:"px-5 pt-5 pb-3"},{default:l(()=>[s(t(Y),{class:"text-base font-semibold text-gray-900 dark:text-white"},{default:l(()=>[...e[6]||(e[6]=[y(" Question Description ",-1)])]),_:1})]),_:1}),s(t(I),{class:"px-5 pb-5"},{default:l(()=>[n("div",{innerHTML:o.value,class:"prose max-w-none dark:prose-invert"},null,8,et),F.value?(d(),A(t(C),{key:0,onClick:e[0]||(e[0]=u=>r.value=!r.value),variant:"link",class:"mt-3 px-0 text-primary dark:text-primary"},{default:l(()=>[y(_(r.value?"Show less":"Read more"),1)]),_:1})):L("",!0)]),_:1})]),_:1}),n("div",tt,[n("h2",st,_((R.value||[]).length)+" Answers",1),s(t(C),{variant:"outline",size:"lg",onClick:e[1]||(e[1]=u=>k.value=!k.value),class:"gap-2"},{default:l(()=>[s(t($e),{class:"h-4 w-4"}),y(" "+_(k.value?"Cancel Answer Writing":"Write an Answer"),1)]),_:1})]),k.value&&f.value?(d(),A(t(P),{key:0,class:"mt-4"},{default:l(()=>[s(t(E),null,{default:l(()=>[s(t(Y),null,{default:l(()=>[...e[7]||(e[7]=[y("Your Answer",-1)])]),_:1})]),_:1}),s(t(I),null,{default:l(()=>[s(Z,{modelValue:z.value,"onUpdate:modelValue":e[2]||(e[2]=u=>z.value=u),placeholder:"Write your answer...","min-height":300},null,8,["modelValue"])]),_:1}),s(t(fe),{class:"flex justify-end"},{default:l(()=>[s(t(C),{onClick:M},{default:l(()=>[...e[8]||(e[8]=[y("Post Your Answer",-1)])]),_:1})]),_:1})]),_:1})):k.value&&!f.value?(d(),A(t(P),{key:1},{default:l(()=>[s(t(I),{class:"text-center py-6"},{default:l(()=>[s(t(ke),{class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e[11]||(e[11]=n("p",{class:"text-lg font-semibold mb-2"},"Sign up or log in to answer",-1)),e[12]||(e[12]=n("p",{class:"text-gray-500 mb-4"},"You need to be logged in to post an answer to this question.",-1)),n("div",at,[s(t(C),{onClick:e[3]||(e[3]=u=>t(g).push("/login"))},{default:l(()=>[...e[9]||(e[9]=[y("Log in",-1)])]),_:1}),s(t(C),{onClick:e[4]||(e[4]=u=>t(g).push("/signup")),variant:"outline"},{default:l(()=>[...e[10]||(e[10]=[y("Sign up",-1)])]),_:1})])]),_:1})]),_:1})):L("",!0),n("div",nt,[s(Je,{items:R.value||[],"auth-user-id":S.value,"max-replies":2,onReply:B,onUpvote:V},null,8,["items","auth-user-id"])])])):(d(),A(be,{key:2,icon:"FileText",title:"Question not found",subtitle:"The question you're looking for doesn't seem to exist.","action-label":"Browse all questions","action-handler":()=>t(g).push("/qna")},null,8,["action-handler"]))]))}};export{Ct as default};
//# sourceMappingURL=QuestionDetail-BnuxHScD.js.map
