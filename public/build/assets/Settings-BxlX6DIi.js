import{c as O,j as G,t as J,aO as K,p as f,q as W,b as u,D as a,d as i,w as l,u as e,k as X,C as P,z as t,M as Y,B as Z,H as p,f as M,N as ee,x as h,A as D,F as se,E as te,I as j,o as c}from"./app-BusCMfsw.js";import{_ as q}from"./Card-rloiMM0U.js";import{_ as ae}from"./CardContent-DRH463jB.js";import{_ as F}from"./CardDescription-CtTeBqrV.js";import{_ as U,a as B}from"./CardTitle-BaSWMxRf.js";import{_ as E}from"./Switch-DvLKv01F.js";import{_ as A}from"./Label-DR-rIVHd.js";import{A as re}from"./arrow-left-rkhBD1L5.js";import{L as ie}from"./loader-circle-C3MxRGn-.js";import{C as oe}from"./chevron-down-AWBRn8gD.js";import{C as ne}from"./chevron-up-BBxhchHE.js";import{M as le}from"./mail-3ZjzIVKa.js";import{C as L}from"./circle-alert-CVqoJgI8.js";/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=O("SmartphoneIcon",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),ue={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},de={class:"flex items-center gap-4 mb-8"},ge={key:0,class:"flex items-center justify-center py-16"},be={class:"text-center"},fe={key:1,class:"space-y-6"},pe={class:"flex items-center justify-between"},ve={class:"flex items-center gap-3"},me={class:"flex items-center gap-3"},xe={class:"space-y-3"},ye={class:"flex items-center gap-3"},he={class:"flex-1"},ke={key:0,class:"mt-2"},_e={class:"flex items-start gap-2"},we={class:"flex items-start gap-2"},De={class:"flex-1"},Se={class:"flex items-start gap-2"},Ce={class:"flex items-center justify-between"},Ne={class:"space-y-3"},Re={__name:"Settings",setup(Pe){const v=G(),s=J(),S=X(),k=K(),C=f(!1),d=f(!1),_=f(!0),m=f(!0),x=f(!0),o=f("checking"),g=f(null),y=f({post_liked:!0,post_commented:!0,comment_liked:!0,question_liked:!0,question_upvoted:!0,question_answered:!0,answer_upvoted:!0,answer_replied:!0,mentioned:!0,followed:!0}),V={post_liked:"Post Likes",post_commented:"Post Comments",comment_liked:"Comment Likes",question_liked:"Question Likes",question_upvoted:"Question Upvotes",question_answered:"Question Answers",answer_upvoted:"Answer Upvotes",answer_replied:"Answer Replies",mentioned:"Mentions",followed:"New Followers"},z=async()=>{if(!v.isAuthenticated){S.push("/login");return}C.value=!0;try{const r=await j.get("/api/v1/settings/notifications",v.config);r.data.status==="success"&&(m.value=r.data.data.email_notifications??!0,x.value=r.data.data.push_notifications??!0,y.value=r.data.data.notification_preferences??y.value),await T()}catch(r){console.error("Error fetching notification settings:",r)}finally{C.value=!1}},T=async()=>{if(!k.isSupported){o.value="unsupported";return}try{const r=await k.checkSubscription(v);o.value=r?"subscribed":"not_subscribed"}catch(r){console.error("Error checking push subscription:",r),o.value="not_subscribed"}},R=async()=>{if(d.value)return;const r=!x.value;x.value=r,await N(),r&&o.value==="not_subscribed"?await $():!r&&o.value==="subscribed"&&await I()},$=async()=>{var r,n;if(!k.isSupported){o.value="unsupported";return}o.value="checking",g.value=null;try{await k.subscribe(v)?o.value="subscribed":o.value="not_subscribed"}catch(b){console.error("Error subscribing to push notifications:",b),o.value="not_subscribed",(r=b.message)!=null&&r.includes("denied")||(n=b.message)!=null&&n.includes("permission")?(o.value="blocked",g.value="Notification permission was denied. Please enable it in your browser settings."):g.value=b.message||"Failed to subscribe to push notifications"}},I=async()=>{try{await k.unsubscribe(v),o.value="not_subscribed",g.value=null}catch(r){console.error("Error unsubscribing from push notifications:",r),g.value=r.message||"Failed to unsubscribe from push notifications"}},N=async()=>{if(!v.isAuthenticated){S.push("/login");return}d.value=!0;try{(await j.put("/api/v1/settings/notifications",{email_notifications:m.value,push_notifications:x.value,notification_preferences:y.value},v.config)).data.status==="success"&&console.log("Notification settings saved successfully")}catch(r){console.error("Error saving notification settings:",r)}finally{d.value=!1}},Q=async r=>{d.value||(y.value[r]=!y.value[r],await N())},H=async()=>{if(d.value)return;const r=!m.value;m.value=r,await N()};return W(()=>{z()}),(r,n)=>(c(),u("div",{class:t(["min-h-screen transition-colors duration-300",e(s).isDark?"bg-gray-950":"bg-gray-50"])},[a("div",ue,[a("div",de,[i(e(P),{variant:"ghost",size:"icon",onClick:n[0]||(n[0]=b=>e(S).back()),class:"flex-shrink-0"},{default:l(()=>[i(e(re),{class:"h-5 w-5"})]),_:1}),a("div",null,[a("h1",{class:t(["text-3xl font-bold",[e(s).isDark?"text-white":"text-gray-900"]])}," Settings ",2),a("p",{class:t(["text-sm mt-1",[e(s).isDark?"text-gray-400":"text-gray-600"]])}," Manage your account settings and preferences ",2)])]),C.value?(c(),u("div",ge,[a("div",be,[i(e(ie),{class:t(["h-8 w-8 animate-spin mx-auto mb-4",[e(s).isDark?"text-gray-400":"text-gray-600"]])},null,8,["class"]),a("p",{class:t([e(s).isDark?"text-gray-400":"text-gray-600"])},"Loading settings...",2)])])):(c(),u("div",fe,[i(e(q),{class:t(["border-0 shadow-sm",e(s).isDark?"bg-gray-900/50":"bg-white"])},{default:l(()=>[i(e(U),null,{default:l(()=>[a("div",pe,[a("div",ve,[a("div",{class:t(["p-2 rounded-lg",[e(s).isDark?"bg-blue-900/30":"bg-blue-100"]])},[i(e(Z),{class:t(["h-5 w-5",[e(s).isDark?"text-blue-400":"text-blue-600"]])},null,8,["class"])],2),a("div",null,[i(e(B),{class:t([e(s).isDark?"text-white":"text-gray-900"])},{default:l(()=>[...n[2]||(n[2]=[p(" Notification Preferences ",-1)])]),_:1},8,["class"]),i(e(F),{class:t([e(s).isDark?"text-gray-400":"text-gray-600"])},{default:l(()=>[...n[3]||(n[3]=[p(" Control how and when you receive notifications ",-1)])]),_:1},8,["class"])])]),i(e(P),{variant:"ghost",size:"icon",onClick:n[1]||(n[1]=b=>_.value=!_.value),class:"flex-shrink-0"},{default:l(()=>[_.value?(c(),M(e(oe),{key:0,class:"h-5 w-5 transition-transform"})):(c(),M(e(ne),{key:1,class:"h-5 w-5 transition-transform"}))]),_:1})])]),_:1}),Y(i(e(ae),{class:"space-y-6"},{default:l(()=>[a("div",{class:t(["flex items-center justify-between p-4 rounded-lg border",[e(s).isDark?"bg-gray-800/30 border-gray-700":"bg-gray-50 border-gray-200"]])},[a("div",me,[a("div",{class:t(["p-2 rounded-lg",[e(s).isDark?"bg-gray-700":"bg-gray-200"]])},[i(e(le),{class:t(["h-4 w-4",[e(s).isDark?"text-gray-300":"text-gray-700"]])},null,8,["class"])],2),a("div",null,[i(e(A),{class:t([[e(s).isDark?"text-white":"text-gray-900"],"text-base font-medium"])},{default:l(()=>[...n[4]||(n[4]=[p(" Email Notifications ",-1)])]),_:1},8,["class"]),a("p",{class:t(["text-sm",[e(s).isDark?"text-gray-400":"text-gray-600"]])}," Receive email notifications for important updates ",2)])]),i(e(E),{checked:m.value,"onUpdate:checked":H,disabled:d.value},null,8,["checked","disabled"])],2),a("div",xe,[a("div",{class:t(["flex items-center justify-between p-4 rounded-lg border",[e(s).isDark?"bg-gray-800/30 border-gray-700":"bg-gray-50 border-gray-200"]])},[a("div",ye,[a("div",{class:t(["p-2 rounded-lg",[e(s).isDark?"bg-gray-700":"bg-gray-200"]])},[i(e(ce),{class:t(["h-4 w-4",[e(s).isDark?"text-gray-300":"text-gray-700"]])},null,8,["class"])],2),a("div",he,[i(e(A),{class:t([[e(s).isDark?"text-white":"text-gray-900"],"text-base font-medium"])},{default:l(()=>[...n[5]||(n[5]=[p(" Push Notifications ",-1)])]),_:1},8,["class"]),a("p",{class:t(["text-sm",[e(s).isDark?"text-gray-400":"text-gray-600"]])}," Receive browser push notifications ",2),o.value!=="checking"&&o.value!=="unsupported"?(c(),u("div",ke,[a("span",{class:t(["text-xs px-2 py-1 rounded-full",[o.value==="subscribed"?e(s).isDark?"bg-green-900/30 text-green-400":"bg-green-100 text-green-700":e(s).isDark?"bg-gray-700 text-gray-400":"bg-gray-200 text-gray-600"]])},D(o.value==="subscribed"?"Subscribed":"Not subscribed"),3)])):h("",!0)])]),i(e(E),{checked:x.value,"onUpdate:checked":R,disabled:d.value||o.value==="unsupported"||o.value==="blocked"},null,8,["checked","disabled"])],2),o.value==="unsupported"?(c(),u("div",{key:0,class:t(["p-3 rounded-lg border",[e(s).isDark?"bg-yellow-900/20 border-yellow-800/50":"bg-yellow-50 border-yellow-200"]])},[a("div",_e,[i(e(L),{class:t(["h-4 w-4 mt-0.5 flex-shrink-0",[e(s).isDark?"text-yellow-400":"text-yellow-600"]])},null,8,["class"]),a("p",{class:t(["text-xs",[e(s).isDark?"text-yellow-300":"text-yellow-700"]])}," Push notifications are not supported in this browser. Please use a modern browser like Chrome, Firefox, or Edge. ",2)])],2)):h("",!0),o.value==="blocked"?(c(),u("div",{key:1,class:t(["p-3 rounded-lg border",[e(s).isDark?"bg-red-900/20 border-red-800/50":"bg-red-50 border-red-200"]])},[a("div",we,[i(e(L),{class:t(["h-4 w-4 mt-0.5 flex-shrink-0",[e(s).isDark?"text-red-400":"text-red-600"]])},null,8,["class"]),a("div",De,[a("p",{class:t(["text-xs font-medium mb-1",[e(s).isDark?"text-red-300":"text-red-700"]])}," Notification permission denied ",2),a("p",{class:t(["text-xs",[e(s).isDark?"text-red-400":"text-red-600"]])},D(g.value||"Please enable notifications in your browser settings and try again."),3)])])],2)):h("",!0),g.value&&o.value!=="blocked"?(c(),u("div",{key:2,class:t(["p-3 rounded-lg border",[e(s).isDark?"bg-red-900/20 border-red-800/50":"bg-red-50 border-red-200"]])},[a("div",Se,[i(e(L),{class:t(["h-4 w-4 mt-0.5 flex-shrink-0",[e(s).isDark?"text-red-400":"text-red-600"]])},null,8,["class"]),a("p",{class:t(["text-xs",[e(s).isDark?"text-red-300":"text-red-700"]])},D(g.value),3)])],2)):h("",!0),x.value&&o.value==="not_subscribed"&&!g.value?(c(),u("div",{key:3,class:t(["p-3 rounded-lg border",[e(s).isDark?"bg-blue-900/20 border-blue-800/50":"bg-blue-50 border-blue-200"]])},[a("div",Ce,[a("p",{class:t(["text-xs",[e(s).isDark?"text-blue-300":"text-blue-700"]])}," Click the toggle above to subscribe to push notifications ",2),i(e(P),{variant:"outline",size:"sm",onClick:$,disabled:d.value},{default:l(()=>[...n[6]||(n[6]=[p(" Subscribe ",-1)])]),_:1},8,["disabled"])])],2)):h("",!0)]),a("div",{class:t(["border-t",[e(s).isDark?"border-gray-700":"border-gray-200"]])},null,2),a("div",null,[a("h3",{class:t(["text-sm font-semibold mb-4",[e(s).isDark?"text-gray-300":"text-gray-700"]])}," Notification Types ",2),a("div",Ne,[(c(!0),u(se,null,te(y.value,(b,w)=>(c(),u("div",{key:w,class:t(["flex items-center justify-between p-3 rounded-lg border transition-colors",[e(s).isDark?"bg-gray-800/30 border-gray-700 hover:bg-gray-800/50":"bg-gray-50 border-gray-200 hover:bg-gray-100"]])},[i(e(A),{class:t([[e(s).isDark?"text-gray-300":"text-gray-700"],"text-sm font-medium cursor-pointer"])},{default:l(()=>[p(D(V[w]||w),1)]),_:2},1032,["class"]),i(e(E),{checked:b,"onUpdate:checked":()=>Q(w),disabled:d.value||!m.value},null,8,["checked","onUpdate:checked","disabled"])],2))),128))]),m.value?h("",!0):(c(),u("p",{key:0,class:t(["text-xs mt-3",[(e(s).isDark,"text-gray-500")]])}," Enable email notifications to configure individual notification types ",2))])]),_:1},512),[[ee,_.value]])]),_:1},8,["class"]),i(e(q),{class:t(["border-0 shadow-sm opacity-50",e(s).isDark?"bg-gray-900/50":"bg-white"])},{default:l(()=>[i(e(U),null,{default:l(()=>[i(e(B),{class:t([e(s).isDark?"text-white":"text-gray-900"])},{default:l(()=>[...n[7]||(n[7]=[p(" More Settings ",-1)])]),_:1},8,["class"]),i(e(F),{class:t([e(s).isDark?"text-gray-400":"text-gray-600"])},{default:l(()=>[...n[8]||(n[8]=[p(" Additional settings will be available soon ",-1)])]),_:1},8,["class"])]),_:1})]),_:1},8,["class"])]))])],2))}};export{Re as default};
//# sourceMappingURL=Settings-BxlX6DIi.js.map
