import{p as C,j as L,L as T,b as x,o as m,D as n,d as a,x as $,w as l,G as h,A as w,u as i,H as k,T as M,z as B,F as P,E as V,f as D,ar as N,M as j,a8 as z,C as E,a as H,J as U,l as q,q as F,k as G,I as R}from"./app-BusCMfsw.js";import{_ as I,a as J}from"./PostCard-BWC1877M.js";import{_ as W}from"./CardFooter-BhG9KwgQ.js";import{_ as K,a as O,b as Q,c as X,d as Y,e as Z,f as ee,g as te}from"./AlertDialogTitle-CaEIQJxU.js";import"./DialogContent-BW3DkoVX.js";import"./bookmark-DBYfvgfa.js";import"./chevron-right-Bojz4hc6.js";const se={class:"bg-gray-800/80 mt-4 shadow-md rounded-lg overflow-hidden mb-4 hover:cursor-pointer hover:bg-gray-700/40 transition-all duration-350 ease-in"},oe={class:"flex items-center p-4"},ne=["src"],ae={key:1,src:"/assets/front/images/user.png",alt:"User Avatar",class:"w-8 h-8 rounded-full"},le={class:"font-semibold text-white"},ie={class:"text-xs text-gray-500"},re={key:0,class:"relative inline-block ml-auto self-start"},me={key:0,class:"absolute right-0 z-10 mt-2 w-32 origin-top-right divide-y divide-gray-100 ring-1 shadow-lg ring-black/5 focus:outline-hidden",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",tabindex:"-1"},ce={class:"",role:"none"},ue={class:"px-4"},de={class:"font-bold text-xl text-white text-gray-800 mb-0"},fe=["innerHTML"],ve={class:"flex items-center space-x-4"},pe=["title"],_e={class:"flex items-center space-x-2"},he={class:"text-white text-sm"},xe={__name:"CommentCard",props:["comment"],emits:["commentDeleted","commentLiked"],setup(t,{emit:y}){const c=C(!1),d=L(),f=y,_=async()=>{if(!d.isAuthenticated)$router.push("/login");else{const u=await axios.get(`/api/v1/comment/like-unlike/${t.comment.id}`,d.config);u.data.status=="success"?f("commentLiked",[t.comment.id,u.data.liked]):alert("Something went wrong")}},s=async()=>{c.value=!1,await axios.delete(`/api/v1/post/comment/${t.comment.id}`,d.config).then(()=>{f("commentDeleted",t.comment.id)})},b=u=>u.replace(/@(\w+)/g,'<a href="/$1">@$1</a>');return(u,e)=>{const v=T("router-link");return m(),x("div",se,[n("div",oe,[a(v,{to:"/"+t.comment.user.username,onClick:e[0]||(e[0]=h(()=>{},["stop"]))},{default:l(()=>{var p,g;return[(p=t.comment.user)!=null&&p.profile_photo?(m(),x("img",{key:0,src:(g=t.comment.user)==null?void 0:g.profile_photo,alt:"User Avatar",class:"w-8 h-8 rounded-full object-cover"},null,8,ne)):(m(),x("img",ae))]}),_:1},8,["to"]),a(v,{onClick:e[1]||(e[1]=h(()=>{},["stop"])),to:"/"+t.comment.user.username,class:"ml-3"},{default:l(()=>[n("p",le,w(t.comment.user.name),1),n("p",ie,"@"+w(t.comment.user.username),1)]),_:1},8,["to"]),i(d).isAuthenticated&&t.comment.owner?(m(),x("div",re,[n("i",{class:"fas fa-ellipsis-v cursor-pointer text-white p-2",onClick:e[2]||(e[2]=h(p=>c.value=!c.value,["stop"]))}),a(M,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:l(()=>[c.value?(m(),x("div",me,[n("div",ce,[a(i(K),null,{default:l(()=>[a(i(I),{"as-child":""},{default:l(()=>[n("div",{onClick:e[3]||(e[3]=h(()=>{},["stop"])),class:"block px-4 py-2 text-sm text-gray-700 transition-all duration-150 ease-in-out rounded-md bg-white hover:bg-gray-200"},[...e[5]||(e[5]=[n("i",{class:"fas fa-trash mr-1"},null,-1),k(" Delete ",-1)])])]),_:1}),a(i(O),null,{default:l(()=>[a(i(Q),null,{default:l(()=>[a(i(X),null,{default:l(()=>[...e[6]||(e[6]=[k("Are you absolutely sure?",-1)])]),_:1}),a(i(Y),null,{default:l(()=>[...e[7]||(e[7]=[k(" This action cannot be undone. This will delete your comment. ",-1)])]),_:1})]),_:1}),a(i(Z),null,{default:l(()=>[a(i(ee),null,{default:l(()=>[...e[8]||(e[8]=[k("Cancel",-1)])]),_:1}),a(i(te),{onClick:h(s,["stop"])},{default:l(()=>[...e[9]||(e[9]=[k("Continue",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])])):$("",!0)]),_:1})])):$("",!0)]),n("div",ue,[n("h3",de,w(t.comment.title),1),n("p",{class:"text-gray-700 mb-2 text-white",innerHTML:b(t.comment.content),onClick:e[4]||(e[4]=h(()=>{},["stop"]))},null,8,fe)]),a(i(W),{class:"flex items-center justify-between p-4 pt-0"},{default:l(()=>[n("div",ve,[n("span",{title:t.comment.likes_count+" Likes",class:"text-white hover:text-red-400"},[n("i",{class:B(["fa-heart",t.comment.liked?"fas text-red-500":"far"]),onClick:h(_,["stop"])},null,2),k("Â "+w(t.comment.likes_count),1)],8,pe)]),n("div",_e,[n("span",he,w(t.comment.posted_at),1)])]),_:1})])}}},ke={__name:"CommentSection",props:["comments","post_code"],emits:["commentAdded","commentDeleted","commentLiked"],setup(t,{emit:y}){const c=y,d=L(),f=C(""),_=C(!1),s=e=>{c("commentDeleted",e)},b=e=>{c("commentLiked",e)},u=async()=>{_.value=!0;const e=await axios.post("/api/v1/post/comment",{code:t.post_code,content:f.value},d.config);_.value=!1,e.data.status=="success"&&(f.value="",c("commentAdded",e.data.comment))};return(e,v)=>(m(),x("div",null,[a(N,{name:"fade",appear:""},{default:l(()=>[(m(!0),x(P,null,V(t.comments,(p,g)=>(m(),D(xe,{key:g,onCommentLiked:b,onCommentDeleted:s,comment:p},null,8,["comment"]))),128))]),_:1}),n("form",{onSubmit:h(u,["prevent"])},[j(n("textarea",{rows:"3",required:"","onUpdate:modelValue":v[0]||(v[0]=p=>f.value=p),placeholder:"Write a comment...",class:"bg-gray-800/80 w-full shadow-md rounded-lg overflow-hidden text-white p-3 mb-2 focus:outline-0 hover:cursor-pointer hover:bg-gray-700/40 transition-all duration-350 ease-in"},null,512),[[z,f.value]]),a(i(E),{type:"submit",class:"bg-green-600 hover:bg-green-700",disabled:_.value},{default:l(()=>[...v[1]||(v[1]=[k(" Submit Post ",-1)])]),_:1},8,["disabled"])],32)]))}},ge={class:"max-w-2xl mx-auto mt-[40px] sm:px-6 pb-5 space-y-5"},Ae={__name:"PostDetail",emits:["share_url"],setup(t,{emit:y}){const c=U(),d=G(),f=L(),_=H(()=>c.params.post_code),s=C(null),b=y,u=async()=>{try{const o=await R.get(`/api/v1/posts/post_${_.value}`,f.config);s.value=o.data}catch(o){console.error("Error fetching post:",o)}},e=o=>{b("share_url",o)},v=o=>{d.push("/feed")},p=async o=>{s.value.liked=o[1],o[1]?s.value.likes_count++:s.value.likes_count--},g=async o=>{s.value.comments.find(r=>r.id==o[0]).liked=o[1],o[1]?s.value.comments.find(r=>r.id==o[0]).likes_count++:s.value.comments.find(r=>r.id==o[0]).likes_count--},S=o=>{s.value.comments=s.value.comments.filter(r=>r.id!==o),s.value.comments_count--},A=o=>{s.value.comments.push(o),s.value.comments_count++};return q(_,()=>{u()}),F(u),(o,r)=>(m(),x("div",ge,[n("h4",{class:"text-vue hover:text-laravel transition-all duration-300 ease-in mb-5 cursor-pointer",onClick:r[0]||(r[0]=ye=>i(d).push("/feed"))},[...r[1]||(r[1]=[n("i",{class:"fas fa-chevron-left fa-sm"},null,-1),n("span",{class:"text-lg"}," Back",-1)])]),s.value?(m(),D(J,{key:0,onShare_url:e,onLiked_action:p,onDelete_post:v,post:s.value},null,8,["post"])):$("",!0),s.value?(m(),D(ke,{key:1,onCommentLiked:g,onCommentDeleted:S,onCommentAdded:A,type:"post",post_code:s.value.post_code,comments:s.value.comments},null,8,["post_code","comments"])):$("",!0)]))}};export{Ae as default};
//# sourceMappingURL=PostDetail-CSzTOcLm.js.map
