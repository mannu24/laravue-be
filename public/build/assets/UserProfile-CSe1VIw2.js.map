{"version":3,"file":"UserProfile-CSe1VIw2.js","sources":["../../../resources/js/views/UserProfile.vue"],"sourcesContent":["<script setup>\nimport { ref, computed, onMounted, watch, onBeforeMount } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { useAuthStore } from '../stores/auth'\nimport { useThemeStore } from '../stores/theme'\nimport { useFollow } from '../composables/useFollow'\nimport ProfileTabs from '../components/profile/ProfileTabs.vue'\nimport ProfileCard from '../components/profile/ProfileCard.vue'\nimport { \n    Users, \n    Building2,\n    FileText\n} from 'lucide-vue-next'\nimport api from '@/lib/api'\nimport { useGlobalDataStore } from '../stores/globalData'\n\n// Declare emits to avoid Vue warnings\ndefineEmits(['share_url'])\n\nconst route = useRoute()\nconst authStore = useAuthStore()\nconst themeStore = useThemeStore()\nconst globalDataStore = useGlobalDataStore()\nconst username = ref(null)\n\nconst user = ref(null)\nconst isLoading = ref(true)\nconst isOwnProfile = computed(() => {\n    return authStore.isAuthenticated && authStore.user?.username === username.value\n})\n\nconst { isFollowing, followersCount, followingCount } = useFollow()\n\n// Computed for gamification data\nconst gamificationSummary = computed(() => {\n  // Get from API response if available, otherwise from globalDataStore\n  if (user.value?.gamification?.summary) {\n    return user.value.gamification.summary\n  }\n  return globalDataStore.gamificationSummary\n})\n\n// Fetch user profile\nconst fetchUserProfile = async () => {\n    isLoading.value = true\n    try {\n        // Use api instance which automatically attaches auth token\n        const response = await api.get(`/users/${username.value}`)\n        \n        if (response.data.status === 'success') {\n            // Handle both old format (data) and new format (data.user)\n            user.value = response.data.data.user || response.data.data\n            followersCount.value = user.value?.followers_count || 0\n            followingCount.value = user.value?.following_count || 0\n            \n            // Set follow status from API response\n            if (authStore.isAuthenticated && !isOwnProfile.value) {\n                isFollowing.value = user.value?.is_following || false\n            }\n            \n            // Store gamification data if available\n            if (response.data.data.gamification) {\n                user.value.gamification = response.data.data.gamification\n            }\n        }\n    } catch (error) {\n        console.error('Error fetching user profile:', error)\n        user.value = null\n    } finally {\n        isLoading.value = false\n    }\n}\n\n// Handle route updates when navigating to same route with different params\nonBeforeMount(async (to, from) => {\n    if (to?.params?.username !== from?.params?.username) {\n        username.value = to.params.username\n        await fetchUserProfile()\n    }\n})\n\n// Watch route params to handle navigation changes (fallback)\nwatch(() => route.params.username, (newUsername) => {\n    if (newUsername && newUsername !== username.value) {\n        username.value = newUsername\n        fetchUserProfile()\n    }\n})\n\nonMounted(async () => {\n    username.value = route.params.username\n    await fetchUserProfile()\n    // Fetch global data if gamification not in response\n    if (!user.value?.gamification) {\n        await globalDataStore.fetchGlobalData()\n    }\n})\n</script>\n\n<template>\n    <div class=\"min-h-screen\">\n        <!-- Loading State -->\n        <div v-if=\"isLoading\" class=\"flex items-center justify-center min-h-screen\">\n            <div class=\"text-center\">\n                <div class=\"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4\" :class=\"[\n                    themeStore.isDark ? 'border-white' : 'border-gray-900'\n                ]\"></div>\n                <p :class=\"[\n                    themeStore.isDark ? 'text-gray-400' : 'text-gray-600'\n                ]\">Loading profile...</p>\n            </div>\n        </div>\n\n        <!-- Profile Content -->\n        <div v-else-if=\"user\">\n            <ProfileCard\n                :user=\"user\"\n                :social-links=\"user.social_links || []\"\n                :gamification-summary=\"gamificationSummary\"\n            />\n\n            <!-- Tabs Section -->\n            <div class=\"pb-5 lg:pb-10\">\n                <ProfileTabs\n                    :user-id=\"user?.id\"\n                    :tabs=\"[\n                        { value: 'feed', label: 'Feed', icon: FileText },\n                        { value: 'projects', label: 'Projects', icon: Building2 },\n                        // { value: 'blogs', label: 'Blogs', icon: FileText }\n                    ]\"\n                    default-tab=\"feed\"\n                    :username=\"username\"\n                    :is-own-profile=\"isOwnProfile\"\n                />\n            </div>\n        </div>\n\n        <!-- Error State -->\n        <div v-else class=\"flex items-center justify-center min-h-screen\">\n            <div class=\"text-center\">\n                <Users class=\"h-16 w-16 mx-auto mb-4 opacity-50\" :class=\"[\n                    themeStore.isDark ? 'text-gray-600' : 'text-gray-400'\n                ]\" />\n                <h2 class=\"text-2xl font-bold mb-2\" :class=\"[\n                    themeStore.isDark ? 'text-white' : 'text-gray-900'\n                ]\">User Not Found</h2>\n                <p :class=\"[\n                    themeStore.isDark ? 'text-gray-400' : 'text-gray-600'\n                ]\">The user you're looking for doesn't exist.</p>\n            </div>\n        </div>\n    </div>\n</template>\n\n<style scoped>\n.fade-enter-active,\n.fade-leave-active {\n    transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n    opacity: 0;\n}\n</style>\n"],"names":["route","useRoute","authStore","useAuthStore","themeStore","useThemeStore","globalDataStore","useGlobalDataStore","username","ref","user","isLoading","isOwnProfile","computed","_a","isFollowing","followersCount","followingCount","useFollow","gamificationSummary","_b","fetchUserProfile","response","api","_c","error","onBeforeMount","to","from","watch","newUsername","onMounted","_openBlock","_createElementBlock","_hoisted_1","_hoisted_2","_createElementVNode","_hoisted_3","_unref","_normalizeClass","_hoisted_4","_createVNode","ProfileCard","_hoisted_5","ProfileTabs","FileText","Building2","_hoisted_6","_hoisted_7","Users"],"mappings":"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"}