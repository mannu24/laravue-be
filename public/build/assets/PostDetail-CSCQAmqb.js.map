{"version":3,"file":"PostDetail-CSCQAmqb.js","sources":["../../../resources/js/components/elements/CommentCard.vue","../../../resources/js/components/CommentSection.vue","../../../resources/js/views/PostDetail.vue"],"sourcesContent":["<script setup>\nimport { ref } from 'vue';\nimport { useAuthStore } from '../../stores/auth';\nimport { CardFooter } from '@/components/ui/card';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from '@/components/ui/alert-dialog'\n\nconst showDropdown = ref(false)\nconst authStore = useAuthStore()\nconst { comment } = defineProps(['comment'])\nconst emit = defineEmits(['commentDeleted', 'commentLiked'])\n\nconst handleLike = async () => {\n    if(!authStore.isAuthenticated) {\n        $router.push('/login')\n    }\n    else {\n        const response = await axios.get(`/api/v1/comment/like-unlike/${comment.id}`, authStore.config)\n        if(response.data.status == 'success') {\n            emit('commentLiked', [comment.id, response.data.liked])\n        }\n        else {\n            alert('Something went wrong')\n        }\n    }\n};\n\nconst deletePost = async () => {\n    showDropdown.value = false\n    await axios.delete(`/api/v1/post/comment/${comment.id}`, authStore.config).then(() => {\n        emit('commentDeleted', comment.id)\n    })\n}\n\nconst renderContent = (content) => {\n    return content.replace(/@(\\w+)/g, '<a href=\"/$1\">@$1</a>');\n};\n</script>\n<template>\n    <div class=\"bg-gray-800/80 mt-4 shadow-md rounded-lg overflow-hidden mb-4 hover:cursor-pointer hover:bg-gray-700/40 transition-all duration-350 ease-in\">\n        <div class=\"flex items-center p-4\">\n            <router-link :to=\"'/' + comment.user.username\" @click.stop>\n                <img v-if=\"comment.user?.profile_photo\" :src=\"comment.user?.profile_photo\" alt=\"User Avatar\"\n                    class=\"w-8 h-8 rounded-full\" />\n                <img v-else src=\"/assets/front/images/user.png\" alt=\"User Avatar\" class=\"w-8 h-8 rounded-full\" />\n            </router-link>\n            <router-link @click.stop :to=\"'/' + comment.user.username\" class=\"ml-3\">\n                <p class=\"font-semibold text-white\">{{ comment.user.name }}</p>\n                <p class=\"text-xs text-gray-500\">@{{ comment.user.username }}</p>\n            </router-link>\n            <div class=\"relative inline-block ml-auto self-start\" v-if=\"authStore.isAuthenticated && comment.owner\">\n                <i class=\"fas fa-ellipsis-v cursor-pointer text-white p-2\" @click.stop=\"showDropdown = !showDropdown\"></i>\n                <transition enter-active-class=\"transition ease-out duration-100\"\n                    enter-from-class=\"transform opacity-0 scale-95\" enter-to-class=\"transform opacity-100 scale-100\"\n                    leave-active-class=\"transition ease-in duration-75\"\n                    leave-from-class=\"transform opacity-100 scale-100\"\n                    leave-to-class=\"transform opacity-0 scale-95\">\n                    <div v-if=\"showDropdown\"\n                        class=\"absolute right-0 z-10 mt-2 w-32 origin-top-right divide-y divide-gray-100 ring-1 shadow-lg ring-black/5 focus:outline-hidden\"\n                        role=\"menu\" aria-orientation=\"vertical\" aria-labelledby=\"menu-button\" tabindex=\"-1\">\n                        <div class=\"\" role=\"none\">\n                            <AlertDialog>\n                                <AlertDialogTrigger as-child>\n                                    <div @click.stop\n                                        class=\"block px-4 py-2 text-sm text-gray-700 transition-all duration-150 ease-in-out rounded-md bg-white hover:bg-gray-200\">\n                                        <i class=\"fas fa-trash mr-1\"></i> Delete\n                                    </div>\n                                </AlertDialogTrigger>\n                                <AlertDialogContent>\n                                    <AlertDialogHeader>\n                                        <AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle>\n                                        <AlertDialogDescription>\n                                            This action cannot be undone. This will delete your comment.\n                                        </AlertDialogDescription>\n                                    </AlertDialogHeader>\n                                    <AlertDialogFooter>\n                                        <AlertDialogCancel>Cancel</AlertDialogCancel>\n                                        <AlertDialogAction @click.stop=\"deletePost\">Continue</AlertDialogAction>\n                                    </AlertDialogFooter>\n                                </AlertDialogContent>\n                            </AlertDialog>\n                        </div>\n                    </div>\n                </transition>\n            </div>\n        </div>\n        <div class=\"px-4\">\n            <h3 class=\"font-bold text-xl text-white text-gray-800 mb-0\">{{ comment.title }}</h3>\n            <p class=\"text-gray-700 mb-2 text-white\" v-html=\"renderContent(comment.content)\" @click.stop></p>\n        </div>\n        <CardFooter class=\"flex items-center justify-between p-4 pt-0\">\n            <div class=\"flex items-center space-x-4\">\n                <span :title=\"comment.likes_count+' Likes'\" class=\"text-white hover:text-red-400\"><i class=\"fa-heart\" :class=\"comment.liked ? 'fas text-red-500':'far'\" @click.stop=\"handleLike\"></i>&nbsp;{{ comment.likes_count }}</span>\n            </div>\n            <div class=\"flex items-center space-x-2\">\n                <span class=\"text-white text-sm\">{{ comment.posted_at }}</span>\n            </div>\n        </CardFooter>\n    </div>\n</template>","<script setup>\nimport { ref } from 'vue';\nimport { useAuthStore } from '../stores/auth';\nimport CommentCard from './elements/CommentCard.vue';\nimport { Button } from '@/components/ui/button';\n\nconst { comments, post_code } = defineProps(['comments', 'post_code'])\n\nconst emit = defineEmits(['commentAdded', 'commentDeleted', 'commentLiked'])\nconst authStore = useAuthStore()\nconst text = ref('')\nconst isSubmitting = ref(false)\n\nconst handleDelete = (id) => {\n    emit('commentDeleted', id)\n}\n\nconst handleLike = (data) => {\n    emit('commentLiked', data)\n}\n\nconst handleSubmit = async () => {\n    isSubmitting.value = true\n    const response = await axios.post('/api/v1/post/comment', {\n        code: post_code, content: text.value\n    }, authStore.config)\n    isSubmitting.value = false\n    if(response.data.status == 'success') {\n        text.value = ''\n        emit('commentAdded', response.data.comment)\n    }\n}\n</script>\n<template>\n    <div>\n        <form @submit.prevent=\"handleSubmit\">\n            <textarea rows=\"3\" required v-model=\"text\" placeholder=\"Write a comment...\"\n            class=\"bg-gray-800/80 w-full shadow-md rounded-lg overflow-hidden text-white p-3 mb-4 focus:outline-0 hover:cursor-pointer hover:bg-gray-700/40 transition-all duration-350 ease-in\" \n            ></textarea>\n            <Button type=\"submit\" class=\"bg-green-600 hover:bg-green-700\" :disabled=\"isSubmitting\">\n                Submit Post\n            </Button>\n        </form>\n        <TransitionGroup name=\"fade\" appear>\n            <CommentCard v-for=\"c,index in comments\" :key=\"index\" @commentLiked=\"handleLike\" @commentDeleted=\"handleDelete\" :comment=\"c\" />\n        </TransitionGroup>\n    </div>\n</template>","<script setup>\nimport { useRoute, useRouter } from 'vue-router';\nimport { ref, onMounted, defineEmits } from 'vue';\nimport { useAuthStore } from '../stores/auth';\nimport axios from 'axios';\nimport PostCard from '../components/feed/PostCard.vue'\nimport CommentSection from '../components/CommentSection.vue'\n\nconst route = useRoute();\nconst router = useRouter();\nconst authStore = useAuthStore();\nconst postcode = route.params.post_code;\nconst post = ref(null);\nconst emit = defineEmits(['share_url'])\n\nconst fetchPost = async () => {\n    try {\n        const response = await axios.get(`/api/v1/posts/post_${postcode}`, authStore.config);\n        post.value = response.data;\n    } catch (error) {\n        console.error('Error fetching post:', error);\n    }\n};\n\nconst share_url = (url) => {\n    emit('share_url', url)\n}\nconst post_deleted = (value) => {\n    router.push('/feed')\n}\n\nconst like_action = async (data) => {\n    post.value.liked = data[1]\n    if (data[1]) {\n        post.value.likes_count++\n    } else {\n        post.value.likes_count--\n    }\n}\n\nconst handleLike = async (data) => {\n    post.value.comments.find(i => i.id == data[0]).liked = data[1]\n    if (data[1]) {\n        post.value.comments.find(i => i.id == data[0]).likes_count++\n    } else {\n        post.value.comments.find(i => i.id == data[0]).likes_count--\n    }\n}\n\nconst handleDelete = (id) => {\n    post.value.comments = post.value.comments.filter((comment) => comment.id !== id)\n    post.value.comments_count--\n}\n\nconst commentAdded = (comment) => {\n    post.value.comments.push(comment)\n    post.value.comments_count++\n}\nonMounted(fetchPost);\n</script>\n\n<template>\n    <div class=\"max-w-2xl mx-auto mt-[40px] sm:px-6 pb-5\">\n        <h4 class=\"text-vue hover:text-laravel transition-all duration-300 ease-in mb-5 cursor-pointer\"\n            @click=\"router.push('/feed')\">\n            <i class=\"fas fa-chevron-left fa-sm\"></i><span class=\"text-lg\"> Back</span>\n        </h4>\n        <PostCard @share_url=\"share_url\" @liked_action=\"like_action\" @delete_post=\"post_deleted\" v-if=\"post\"\n            :post=\"post\" />\n        <CommentSection @commentLiked=\"handleLike\" @commentDeleted=\"handleDelete\" @commentAdded=\"commentAdded\"\n            type=\"post\" :post_code=\"post.post_code\" v-if=\"post\" :comments=\"post.comments\" />\n    </div>\n</template>\n"],"names":["showDropdown","ref","authStore","useAuthStore","emit","__emit","handleLike","response","__props","deletePost","renderContent","content","text","isSubmitting","handleDelete","id","data","handleSubmit","route","useRoute","router","useRouter","postcode","post","fetchPost","axios","error","share_url","url","post_deleted","value","like_action","i","comment","commentAdded","onMounted"],"mappings":"w4CAMA,MAAMA,EAAeC,EAAI,EAAK,EACxBC,EAAYC,EAAY,EAExBC,EAAOC,EAEPC,EAAa,SAAY,CAC3B,GAAG,CAACJ,EAAU,gBACV,QAAQ,KAAK,QAAQ,MAEpB,CACD,MAAMK,EAAW,MAAM,MAAM,IAAI,+BAA+BC,UAAQ,EAAE,GAAIN,EAAU,MAAM,EAC3FK,EAAS,KAAK,QAAU,UACvBH,EAAK,eAAgB,CAACI,EAAA,QAAQ,GAAID,EAAS,KAAK,KAAK,CAAC,EAGtD,MAAM,sBAAsB,CAExC,CACA,EAEME,EAAa,SAAY,CAC3BT,EAAa,MAAQ,GACrB,MAAM,MAAM,OAAO,wBAAwBQ,EAAO,QAAC,EAAE,GAAIN,EAAU,MAAM,EAAE,KAAK,IAAM,CAClFE,EAAK,iBAAkBI,EAAO,QAAC,EAAE,CACpC,CAAA,CACL,EAEME,EAAiBC,GACZA,EAAQ,QAAQ,UAAW,uBAAuB,klFC1B7D,MAAMP,EAAOC,EACPH,EAAYC,EAAY,EACxBS,EAAOX,EAAI,EAAE,EACbY,EAAeZ,EAAI,EAAK,EAExBa,EAAgBC,GAAO,CACzBX,EAAK,iBAAkBW,CAAE,CAC7B,EAEMT,EAAcU,GAAS,CACzBZ,EAAK,eAAgBY,CAAI,CAC7B,EAEMC,EAAe,SAAY,CAC7BJ,EAAa,MAAQ,GACrB,MAAMN,EAAW,MAAM,MAAM,KAAK,uBAAwB,CACtD,KAAMC,YAAW,QAASI,EAAK,KAClC,EAAEV,EAAU,MAAM,EACnBW,EAAa,MAAQ,GAClBN,EAAS,KAAK,QAAU,YACvBK,EAAK,MAAQ,GACbR,EAAK,eAAgBG,EAAS,KAAK,OAAO,EAElD,s1BCvBA,MAAMW,EAAQC,EAAU,EAClBC,EAASC,EAAW,EACpBnB,EAAYC,EAAc,EAC1BmB,EAAWJ,EAAM,OAAO,UACxBK,EAAOtB,EAAI,IAAI,EACfG,EAAOC,EAEPmB,EAAY,SAAY,CAC1B,GAAI,CACA,MAAMjB,EAAW,MAAMkB,EAAM,IAAI,sBAAsBH,CAAQ,GAAIpB,EAAU,MAAM,EACnFqB,EAAK,MAAQhB,EAAS,IACzB,OAAQmB,EAAO,CACZ,QAAQ,MAAM,uBAAwBA,CAAK,CACnD,CACA,EAEMC,EAAaC,GAAQ,CACvBxB,EAAK,YAAawB,CAAG,CACzB,EACMC,EAAgBC,GAAU,CAC5BV,EAAO,KAAK,OAAO,CACvB,EAEMW,EAAc,MAAOf,GAAS,CAChCO,EAAK,MAAM,MAAQP,EAAK,CAAC,EACrBA,EAAK,CAAC,EACNO,EAAK,MAAM,cAEXA,EAAK,MAAM,aAEnB,EAEMjB,EAAa,MAAOU,GAAS,CAC/BO,EAAK,MAAM,SAAS,KAAKS,GAAKA,EAAE,IAAMhB,EAAK,CAAC,CAAC,EAAE,MAAQA,EAAK,CAAC,EACzDA,EAAK,CAAC,EACNO,EAAK,MAAM,SAAS,KAAKS,GAAKA,EAAE,IAAMhB,EAAK,CAAC,CAAC,EAAE,cAE/CO,EAAK,MAAM,SAAS,KAAKS,GAAKA,EAAE,IAAMhB,EAAK,CAAC,CAAC,EAAE,aAEvD,EAEMF,EAAgBC,GAAO,CACzBQ,EAAK,MAAM,SAAWA,EAAK,MAAM,SAAS,OAAQU,GAAYA,EAAQ,KAAOlB,CAAE,EAC/EQ,EAAK,MAAM,gBACf,EAEMW,EAAgBD,GAAY,CAC9BV,EAAK,MAAM,SAAS,KAAKU,CAAO,EAChCV,EAAK,MAAM,gBACf,EACA,OAAAY,EAAUX,CAAS"}